<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guy's Guide to Ladies</title>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Segoe UI',sans-serif;background:#0f0f0f;color:#fff;min-height:100vh}
  header{background:linear-gradient(135deg,#1a1a2e,#16213e);padding:20px;text-align:center;border-bottom:2px solid #e94560}
  header h1{font-size:1.8em;font-weight:900;letter-spacing:1px}
  header h1 span{color:#e94560}
  header p{color:#888;font-size:0.85em;margin-top:4px}
  nav{display:flex;background:#1a1a1a;border-bottom:1px solid #222}
  nav button{flex:1;padding:12px;background:none;border:none;color:#888;font-size:0.85em;cursor:pointer;font-weight:600;letter-spacing:.5px;text-transform:uppercase;transition:all .2s}
  nav button.active{color:#e94560;border-bottom:2px solid #e94560}
  nav button:hover{color:#fff}
  .page{display:none;padding:20px;max-width:600px;margin:0 auto}
  .page.active{display:block}
  #auth-screen{position:fixed;inset:0;background:#0f0f0f;z-index:100;display:flex;align-items:center;justify-content:center;padding:20px;overflow-y:auto}
  .auth-card{background:#1a1a2e;border-radius:20px;padding:36px 30px;width:100%;max-width:400px;text-align:center}
  .auth-card .logo{font-size:3em;margin-bottom:12px}
  .auth-card h2{font-size:1.5em;font-weight:900;margin-bottom:6px}
  .auth-card h2 span{color:#e94560}
  .auth-card>p{color:#888;font-size:0.88em;margin-bottom:28px}
  .auth-tabs{display:flex;background:#0f0f0f;border-radius:10px;padding:4px;margin-bottom:24px}
  .auth-tab{flex:1;padding:10px;background:none;border:none;color:#888;cursor:pointer;border-radius:8px;font-weight:600;font-size:0.9em;transition:all .2s}
  .auth-tab.active{background:#e94560;color:#fff}
  label{display:block;color:#aaa;font-size:0.82em;margin-bottom:6px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;text-align:left}
  input,select{width:100%;padding:12px 16px;background:#0f0f0f;border:1px solid #333;border-radius:10px;color:#fff;font-size:1em;margin-bottom:16px;outline:none;font-family:inherit;appearance:none}
  input:focus,select:focus{border-color:#e94560}
  select option{background:#1a1a2e}
  .btn{background:#e94560;color:#fff;border:none;padding:14px 28px;border-radius:10px;font-size:1em;font-weight:700;cursor:pointer;width:100%;transition:background .2s;letter-spacing:.5px;margin-bottom:10px;display:block;font-family:inherit}
  .btn:hover{background:#c73652}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .btn-outline{background:transparent;border:2px solid #e94560;color:#e94560}
  .btn-outline:hover{background:#e94560;color:#fff}
  .btn-green{background:#1a6b1a;border:2px solid #44cc44;color:#44cc44}
  .btn-green:hover{background:#44cc44;color:#000}
  .btn-sm{padding:8px 16px;font-size:0.85em;width:auto;display:inline-block}
  .err{background:#3d0000;border:1px solid #cc0033;border-radius:8px;padding:10px 14px;color:#ff8888;font-size:0.85em;margin-bottom:14px;display:none;text-align:left}
  .phase-banner{border-radius:16px;padding:24px;margin-bottom:20px;text-align:center}
  .phase-banner h2{font-size:1em;text-transform:uppercase;letter-spacing:2px;opacity:.8}
  .phase-banner h3{font-size:2em;font-weight:900;margin:6px 0 4px}
  .phase-banner .day-badge{font-size:.9em;opacity:.7;margin-bottom:6px}
  .phase-banner .one-liner{font-size:.95em;font-style:italic;color:rgba(255,255,255,.9);margin:10px 0 6px;background:rgba(0,0,0,.3);border-radius:8px;padding:10px 16px;display:inline-block;line-height:1.5}
  .phase-banner .emoji{font-size:3em;margin-bottom:8px;display:block}
  .cycle-bar{background:#222;border-radius:100px;height:10px;margin:10px 0 4px;overflow:hidden}
  .cycle-bar-fill{height:100%;border-radius:100px}
  .cycle-meta{display:flex;justify-content:space-between;font-size:.75em;color:#666}
  .card{background:#1a1a1a;border-radius:14px;padding:20px;margin-bottom:16px;border-left:4px solid #e94560}
  .card h4{font-size:.8em;text-transform:uppercase;letter-spacing:1px;color:#e94560;margin-bottom:10px;font-weight:700}
  .card p{color:#ccc;line-height:1.6;font-size:.95em}
  .tip-list{list-style:none}
  .tip-list li{padding:8px 0;color:#ccc;font-size:.9em;border-bottom:1px solid #222;line-height:1.5}
  .tip-list li:last-child{border-bottom:none}
  .dont-say{background:#1a0a0a;border-left-color:#ff4444}
  .dont-say h4{color:#ff4444}
  .dont-item{background:#2a1111;border-radius:8px;padding:10px 14px;margin-bottom:8px;font-size:.88em;color:#ffaaaa;font-style:italic}
  .dont-item::before{content:'ğŸš« '}
  .win-points{background:#0a1a0a;border-left-color:#44cc44}
  .win-points h4{color:#44cc44}
  .phase-ref{background:#1a1a1a;border-radius:14px;padding:18px;margin-bottom:14px}
  .no-data{text-align:center;padding:60px 20px}
  .no-data .big{font-size:4em;margin-bottom:16px}
  .no-data p{color:#888;margin-bottom:24px}
  .history-item{background:#1a1a1a;border-radius:10px;padding:12px 16px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;font-size:.9em}
  .del{background:none;border:none;color:#555;cursor:pointer;font-size:1.1em}
  .del:hover{color:#e94560}
  .learned-badge{background:#1a2a0a;border:1px solid #44cc44;border-radius:8px;padding:8px 12px;font-size:.82em;color:#aaffaa;margin-bottom:16px;text-align:center}
  .section-title{font-size:.8em;text-transform:uppercase;letter-spacing:1px;color:#666;margin:20px 0 10px;font-weight:700}
  hr{border:none;border-top:1px solid #222;margin:20px 0}
  .setup-card{background:#1a1a2e;border-radius:16px;padding:30px}
  .user-bar{display:flex;align-items:center;justify-content:space-between;background:#1a1a1a;border-radius:10px;padding:10px 16px;margin-bottom:20px;font-size:.85em}
  .user-bar span{color:#888}
  .tag{display:inline-block;background:#e94560;border-radius:6px;padding:2px 8px;font-size:.75em;font-weight:700;margin-left:8px;vertical-align:middle}
  .stage-badge{display:inline-block;border-radius:6px;padding:3px 10px;font-size:.75em;font-weight:700;margin-left:8px;vertical-align:middle;background:#2a1a3d;color:#cc99ff;border:1px solid #6633cc}
  .loading{text-align:center;padding:60px 20px;color:#888}
  .spinner{display:inline-block;width:32px;height:32px;border:3px solid #333;border-top-color:#e94560;border-radius:50%;animation:spin .8s linear infinite;margin-bottom:12px}
  @keyframes spin{to{transform:rotate(360deg)}}
  .emailjs-info{background:#1a1a0a;border:1px solid #665500;border-radius:10px;padding:14px;margin-bottom:16px;font-size:.82em;color:#ccaa44;line-height:1.8}
  .emailjs-info a{color:#ffcc44}
  .warning-banner{background:#2a1a00;border:1px solid #cc7700;border-radius:10px;padding:12px 16px;margin-bottom:16px;font-size:.85em;color:#ffaa44;line-height:1.6}
  .focus-card{border-radius:14px;padding:20px;margin-bottom:16px;text-align:center}
  .focus-card .focus-emoji{font-size:2.5em;margin-bottom:8px}
  .focus-card h3{font-size:1.2em;font-weight:900;margin-bottom:6px}
  .focus-card p{font-size:.9em;opacity:.85;line-height:1.6}
  .overview-card{background:#1a1a2e;border-radius:14px;padding:20px;margin-bottom:16px;border-left:4px solid #6633cc}
  .overview-card h4{color:#cc99ff;font-size:.8em;text-transform:uppercase;letter-spacing:1px;font-weight:700;margin-bottom:10px}
  .rel-badge{display:inline-block;padding:3px 10px;border-radius:6px;font-size:.75em;font-weight:700;margin-bottom:12px;background:#1a2a3a;color:#66aaff;border:1px solid #336699}
  footer{text-align:center;padding:20px;color:#333;font-size:.75em}
  .two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:400px){.two-col{grid-template-columns:1fr}}
</style>
</head>
<body>

<div id="auth-screen">
  <div class="auth-card">
    <div class="logo">ğŸ¯</div>
    <h2>GUY'S GUIDE TO <span>LADIES</span></h2>
    <p>Your daily relationship intelligence system</p>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tab-login">Sign In</button>
      <button class="auth-tab" id="tab-signup">Create Account</button>
    </div>
    <div id="auth-err" class="err"></div>
    <div id="login-form">
      <label>Email</label><input type="email" id="login-email" placeholder="you@example.com"/>
      <label>Password</label><input type="password" id="login-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"/>
      <button class="btn" id="btn-login">Sign In</button>
      <button class="btn btn-outline" id="btn-google-1">ğŸ”µ Continue with Google</button>
    </div>
    <div id="signup-form" style="display:none">
      <label>Your Name</label><input type="text" id="signup-name" placeholder="e.g. Mike"/>
      <label>Email</label><input type="email" id="signup-email" placeholder="you@example.com"/>
      <label>Password</label><input type="password" id="signup-pass" placeholder="min 6 characters"/>
      <button class="btn" id="btn-signup">Create Account</button>
      <button class="btn btn-outline" id="btn-google-2">ğŸ”µ Continue with Google</button>
    </div>
  </div>
</div>

<header>
  <h1>GUY'S GUIDE TO <span>LADIES</span></h1>
  <p>Your daily relationship intelligence system</p>
</header>
<nav>
  <button class="active" id="nav-dashboard">ğŸ“Š Today</button>
  <button id="nav-setup">âš™ï¸ Setup</button>
  <button id="nav-reference">ğŸ“– Guide</button>
</nav>
<div id="dashboard" class="page active"><div class="loading"><div class="spinner"></div><p>Loading...</p></div></div>
<div id="setup" class="page"></div>
<div id="reference" class="page"></div>
<footer>Made with â¤ï¸ for the guys who actually give a damn</footer>

<script>
// â”€â”€ Seed random â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function seedRand(s){return()=>{s=Math.sin(s)*10000;return s-Math.floor(s);}}
function dailySeed(){const d=new Date();return d.getFullYear()*10000+(d.getMonth()+1)*100+d.getDate();}
function pickN(arr,n,rng){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(rng()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a.slice(0,n);}
function pickOne(arr,rng){return arr[Math.floor(rng()*arr.length)];}

// â”€â”€ Life stage helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getLifeStage(age){
  const a=parseInt(age)||30;
  if(a<=17) return 'teen';
  if(a<=25) return 'youngadult';
  if(a<=39) return 'adult';
  if(a<=54) return 'perimenopause';
  if(a<=58) return 'menopause';
  return 'postmenopause';
}
function isRomantic(rel){return rel==='wife'||rel==='girlfriend';}
function stageLabel(s){return{'teen':'ğŸ‘§ Teen','youngadult':'ğŸŒ¸ Young Adult','adult':'ğŸ’ª Adult','perimenopause':'ğŸŒ¿ Perimenopause','menopause':'ğŸŒ™ Menopause','postmenopause':'âœ¨ Post-Menopause'}[s]||s;}
function relLabel(r){return{'wife':'ğŸ‘° Wife','girlfriend':'ğŸ’‘ Girlfriend','friend':'ğŸ‘¯ Friend','mom':'ğŸ’ Mom','daughter':'ğŸŒŸ Daughter'}[r]||r;}

// â”€â”€ MENOPAUSE / POST DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const MENO_FOCUSES=[
  {emoji:'ğŸ”¥',name:'Hot Flash Day',color:'linear-gradient(135deg,#3d1500,#7a2a00)',
   overview:'Hot flashes can hit without warning today. Temperature regulation is off and her body is working hard to compensate. This is one of the most physically disruptive symptoms of this transition.',
   tips:['âœ… Keep the bedroom and living space cooler than usual','âœ… Have a cold drink ready for her without being asked','âœ… Don\'t comment on sweating or flushing â€” just quietly help','âœ… Keep a fan nearby','âœ… Avoid lighting candles or cranking the heat'],
   donts:['âŒ Don\'t crank the heat up','âŒ Don\'t comment on how red she looks','âŒ Don\'t suggest she "just cool down"'],
   winpoints_all:['ğŸŒ¬ï¸ Set up a fan in the bedroom before she asks','ğŸ§Š Have cold water or iced drinks ready throughout the day','ğŸ›ï¸ Use breathable cotton bedding â€” swap the heavy duvet','ğŸŒ¡ï¸ Turn the thermostat down a few degrees quietly','ğŸ’† Offer a cool compress or cold towel for her neck','ğŸ›’ Pick up a personal fan or cooling spray as a surprise','ğŸ§´ Get her a cooling mist spray â€” they\'re a game changer','ğŸ¥— Suggest lighter, cooler meals tonight â€” no heavy hot food','ğŸ Look up menopause cooling products and surprise her with one','ğŸ‘• Wash and have her lightest, most breathable clothes ready']},
  {emoji:'ğŸ§ ',name:'Brain Fog Day',color:'linear-gradient(135deg,#0d1a3d,#1a2a6b)',
   overview:'Estrogen plays a big role in cognitive function. As it fluctuates, memory, focus and mental clarity can dip. She\'s not losing it â€” her brain chemistry is genuinely shifting. Be patient and supportive.',
   tips:['âœ… Don\'t put her on the spot or expect fast decisions today','âœ… Write things down rather than relying on her to remember','âœ… Be patient if she loses her train of thought','âœ… Handle logistics and admin where you can','âœ… Keep the environment calm and low-stimulus'],
   donts:['âŒ Don\'t say "you already told me that"','âŒ Don\'t make her feel silly for forgetting things','âŒ Don\'t pile on decisions or information'],
   winpoints_all:['ğŸ“‹ Take over any shared admin or logistics tasks today','ğŸ§˜ Keep the house calm and low on noise and chaos','ğŸ’¬ Be patient mid-conversation if she loses her train of thought','ğŸ—’ï¸ Offer to write things down for her without making it a big deal','â˜• Bring her coffee or tea â€” caffeine helps clarity slightly','ğŸ›’ Offer to handle the grocery list and shopping','ğŸ“± Set reminders for her if she asks, without judgment','ğŸ¤ Remind her she\'s sharp, capable, and absolutely fine','ğŸ³ Cook dinner so she doesn\'t have to think about it','ğŸ§© Don\'t quiz her or test her memory â€” just quietly support']},
  {emoji:'ğŸ˜”',name:'Emotional Intensity Day',color:'linear-gradient(135deg,#2a0a2a,#4a1a4a)',
   overview:'Hormonal fluctuations during menopause directly impact serotonin and dopamine. Feelings of sadness, anxiety, or irritability can surface seemingly out of nowhere. This is neurochemical â€” not weakness.',
   tips:['âœ… Listen without trying to fix or explain','âœ… Validate her feelings without minimising them','âœ… Be a calm, steady presence','âœ… Don\'t take emotional reactions personally','âœ… Check in gently â€” a simple "you okay?" goes a long way'],
   donts:['âŒ Don\'t say "it\'s just your hormones"','âŒ Don\'t dismiss or minimise what she\'s feeling','âŒ Don\'t give her space without checking in first'],
   winpoints_all:['ğŸ¤— Give her a long, genuine hug and hold it','ğŸ’Œ Send a thoughtful text during the day â€” just checking in','ğŸ•¯ï¸ Create a calm atmosphere at home â€” dim lights, quiet music','ğŸ›‹ï¸ Sit with her and just be present â€” no agenda','ğŸŒ¸ Pick up flowers on the way home â€” no reason needed','ğŸ• Order her favourite comfort food for dinner','ğŸ¬ Queue up her comfort show or film','ğŸ’¬ Tell her something specific you love and appreciate about her','ğŸ§– Offer a no-expectation massage â€” back, shoulders, feet','ğŸ“– If she needs space, give it lovingly â€” check back in an hour']},
  {emoji:'ğŸ˜´',name:'Sleep Disruption Day',color:'linear-gradient(135deg,#0a1a2a,#1a2a3d)',
   overview:'Night sweats and hormonal shifts frequently disrupt sleep during menopause. Poor sleep compounds every other symptom â€” mood, energy, cognition, and physical discomfort all worsen without proper rest.',
   tips:['âœ… Let her sleep in or rest without disturbance','âœ… Keep noise levels down in the morning','âœ… Offer to handle morning responsibilities','âœ… Suggest an early, quiet evening','âœ… Make the bedroom as cool and comfortable as possible'],
   donts:['âŒ Don\'t wake her unnecessarily','âŒ Don\'t make noise in the morning if she\'s still resting','âŒ Don\'t dismiss tiredness as laziness'],
   winpoints_all:['ğŸ›ï¸ Make the bedroom cool, dark, and quiet before bedtime','ğŸŒ¡ï¸ Adjust the thermostat for better sleep temperature','â˜• Let her sleep in and handle the morning yourself','ğŸ§˜ Suggest an early, relaxed evening with no commitments','ğŸµ Make her a calming herbal tea before bed','ğŸ“µ Keep your phone on silent so it doesn\'t wake her','ğŸ§´ Get lavender pillow spray or a sleep aid as a small gift','ğŸ›’ Research and pick up magnesium supplements â€” they help with sleep','ğŸ§ Set up white noise or a fan if it helps her sleep','ğŸ’¤ Handle any overnight disruptions so she can get back to sleep']},
  {emoji:'âš¡',name:'Low Energy Day',color:'linear-gradient(135deg,#1a1a0a,#2a2a1a)',
   overview:'Hormonal changes, sleep disruption, and the metabolic shifts of menopause can create significant fatigue. Her body is doing enormous work. Low energy today isn\'t laziness â€” it\'s biology.',
   tips:['âœ… Reduce her mental and physical load where possible','âœ… Don\'t plan demanding activities or events','âœ… Handle chores and logistics proactively','âœ… Let her rest without guilt','âœ… Keep the environment calm and low-pressure'],
   donts:['âŒ Don\'t suggest she "push through it"','âŒ Don\'t fill the day with plans and obligations','âŒ Don\'t make her feel guilty for resting'],
   winpoints_all:['ğŸ§¹ Do all the household chores quietly â€” no announcement','ğŸ›’ Handle all shopping, errands, and logistics today','ğŸ² Cook a nourishing, easy meal â€” she doesn\'t need to think about food','ğŸ›‹ï¸ Create a comfortable resting space â€” blanket, cushions, remote nearby','ğŸ“º Set up her favourite show or film without being asked','â˜• Keep her supplied with her favourite hot drinks all day','ğŸ’Š Make sure she has any supplements she takes ready and available','ğŸ§– Offer a foot or back massage to help her relax and recharge','ğŸš— Offer to drive anywhere she needs to go today','ğŸŒº Small flowers or a treat â€” remind her she\'s loved on tough days']}
];

const POSTMENO_DATA={
  overview:'Hormone levels have settled at their new, lower baseline. The storm has passed. She may experience lower estrogen effects â€” joint stiffness, dryness, mood shifts â€” but the intense transitional symptoms have eased. This is a new chapter, and she deserves a partner who shows up for it.',
  tips:['âœ… Continue being attentive â€” lower estrogen still affects mood and energy','âœ… Encourage and support her interests, friendships, and independence','âœ… Be affectionate and warm â€” physical touch remains important','âœ… Plan gentle, enjoyable activities together','âœ… Celebrate who she is at this stage â€” she\'s earned it'],
  donts:['âŒ Don\'t assume everything is back to normal â€” some symptoms persist','âŒ Don\'t make her feel invisible or less relevant','âŒ Don\'t overlook signs of low mood or isolation'],
  winpoints:['ğŸŒº Plan a lovely day out â€” something relaxed and enjoyable','ğŸ’Œ Write her a note about what you admire about her strength','ğŸ§– Book her a spa day or massage as a treat','ğŸŒ Plan a trip or experience she\'s been wanting','â˜• Regular coffee or lunch dates â€” invest in quality time','ğŸ’ Flowers regularly â€” keep the romance alive','ğŸ Thoughtful gifts that reflect her interests and passions','ğŸ¤ Support her friendships â€” encourage her social life','ğŸ­ Book tickets to something cultural she\'d enjoy','ğŸ’¬ Have deep, meaningful conversations â€” she has so much wisdom']
};

// â”€â”€ PHASE DATA (Standard Cycles) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PHASES=[
  {name:'Menstruation',days:[1,2,3,4,5],emoji:'ğŸ”´',color:'linear-gradient(135deg,#3d0000,#7a0020)',
   oneliners:{
     wife:["Bro, she's on her period. Your job this week is simple: snacks, patience, and zero drama. That's it.","She's not feeling great and that's okay. Be the husband who shows up quietly. Big points for small things right now.","Period week, mate. Keep your mouth shut, your phone down, and the chocolate stocked. Easy win.","She's bleeding and her hormones are in the basement. Be warm, be quiet, be useful. In that order.","Think of this as the reset week. Less talk, more doing. She'll remember how you showed up."],
     girlfriend:["Bro, she's on her period. This week your job is snacks, patience, and shutting up about the guys trip. Simple.","She's not at her best physically â€” be the guy who makes it easier, not harder.","Period week. Be low-maintenance, high-kindness. She'll clock it.","She needs comfort, not conversation. Show up with warmth and zero agenda.","Less is more this week, mate. Be present, be gentle, be useful."],
     friend:["Your girl mate's on her period and probably not feeling great. Check in, don't push plans, be a decent human.","She might cancel or go quiet this week â€” don't take it personally. Shoot her a kind message instead.","Be the friend who checks in without needing anything back. That's the move right now.","A simple 'hey, you good?' goes further than you think this week.","Don't push social plans. Let her come to you when she's ready."],
     mom:["Your mum's not feeling great this week, son. Be helpful, be kind, and don't add to her load.","Call her. Do something useful. Be the kid she brags about â€” especially this week.","She carried you for nine months. The least you can do is be extra patient this week.","Help out without being asked. That's worth more than you know right now.","Be the son who shows up this week. Call, help, be present."],
     daughter:["Your daughter's not feeling well, dad. Go easy on the expectations and make sure she knows you've got her back.","Low energy, possible discomfort. Keep things light and don't push for big talks this week.","Be the safe, calm presence she needs right now. No big conversations, no pressure.","Check in gently. Make sure she has what she needs. That's your job this week.","Dad mode: active. She needs comfort and zero pressure right now."]
   },
   hormones:'Estrogen and progesterone are at their lowest point. The uterine lining is shedding, which takes real physical energy. Cramps, back pain, fatigue, and heightened emotional sensitivity are all physiologically real â€” not manufactured.',
   mood:'Tired, possibly uncomfortable, emotionally sensitive. She needs warmth and understanding, not logic or demands.',
   dos_all:['âœ… Be extra patient and understanding','âœ… Bring her comfort food or her favourite snack','âœ… Offer a heating pad or hot water bottle','âœ… Let her choose what you watch','âœ… Handle chores quietly without making it a big deal','âœ… Keep the vibe calm and pressure-free'],
   donts_all:['âŒ Don\'t bring up money, big plans, or unresolved issues','âŒ Don\'t start serious debates','âŒ Don\'t minimise her pain or discomfort','âŒ Don\'t make her feel guilty for resting','âŒ Don\'t bring up the guys trip'],
   notsay_romantic:["\"You're always like this once a month\"","\"It's just cramps, you'll be fine\"","\"Can I go out with the guys this weekend?\"","\"Why are you so moody?\"","\"Other girls don't make such a big deal\"","\"You're being so sensitive right now\""],
   notsay_friend:["\"You're being so dramatic\"","\"Can you just snap out of it?\"","\"You cancelled on me again\"","\"You seem really moody lately\""],
   notsay_family:["\"You're always difficult this week\"","\"What's wrong with you?\"","\"You're overreacting\"","\"Just push through it\""],
   winpoints_romantic:['ğŸ’† Back or foot massage â€” no strings attached','ğŸ« Surprise her with chocolate or her comfort food','ğŸ“º Cosy night in â€” her choice of show, zero complaints','ğŸ› Draw her a warm bath','ğŸ§¹ Quietly clean the kitchen or bathroom','ğŸ›’ Pick up whatever she needs without being asked','ğŸµ Make her a hot drink exactly how she likes it','ğŸ“± Send a sweet "thinking of you" text mid-day','ğŸ›ï¸ Let her rest without interrupting','ğŸ² Cook her a warm, comforting meal'],
   winpoints_friend:['ğŸ“± Send a "hey, you good?" message â€” genuine, no agenda','ğŸµ Drop off or suggest comfort food if you\'re nearby','ğŸ¬ Suggest a low-key catch-up when she\'s feeling better','ğŸ’¬ Just listen if she wants to vent â€” no advice needed','ğŸ›’ Offer to pick something up if you\'re passing'],
   winpoints_family:['ğŸ“ Call her and ask how she\'s doing','ğŸ² Cook or bring her a meal','ğŸ§¹ Help around the house without being asked','ğŸ’¬ Be patient and kind in every interaction','ğŸ›’ Handle errands for her if you can']
  },
  {name:'Follicular Phase',days:[6,7,8,9,10,11,12],emoji:'ğŸŒ¸',color:'linear-gradient(135deg,#0a2a3d,#0d4a6b)',
   oneliners:{
     wife:["Bro, she's basically a cheat code right now. Estrogen is up, mood is great, she's open to everything. Plan something. Don't waste this window.","This is the green light week, mate. She'll say yes to almost anything. Have you booked that trip yet?","She's sharp, happy, and social. If you've been putting off a big conversation â€” this is your window. Don't blow it.","Her energy is through the roof right now. Match it or get left behind. Plan a proper date.","This is her superhero phase. Be the sidekick she deserves this week â€” plans, adventures, and actual effort."],
     girlfriend:["Bro, she's in her element right now. Happy, energetic, social. Stop sitting at home â€” plan something.","Green light week. She's up for new things, big conversations, and actual adventures. What are you waiting for?","She's firing on all cylinders. Match her energy or she'll outshine you. Plan a date. Actually follow through.","This is the week to bring up anything important. She's sharp, open, and receptive. Go.","Her vibe is immaculate right now. Don't waste it on Netflix. Take her somewhere worth remembering."],
     friend:["Your girl friend is in her prime social mode right now. Stop cancelling and actually make plans.","She's sharp, energetic, and up for fun. Good time to suggest that thing you've both been talking about doing.","She's in a great headspace this week â€” perfect time for a proper catch-up or to plan something fun together.","Social energy is high. She'll be great company. Make the effort and reach out.","She's in a good place this week. Don't let it pass without making plans."],
     mom:["Your mum's in a good headspace this week â€” great time to call, catch up, and actually listen.","She's feeling positive and social. Take her out for lunch or coffee. She'll love it.","Good week to have a proper conversation with your mum. She's sharp and engaged â€” use the time well.","She'd love to hear from you this week. Call her. Make plans. Show up.","She's energetic and in good spirits. Plan something with her â€” doesn't need to be big, just intentional."],
     daughter:["She's in a great mood and full of energy this week, dad. Great time for quality time together.","She's open, happy, and engaged. Perfect week to connect â€” ask about her life, her plans, her dreams.","Good week for a proper father-daughter hang. She's in her element â€” take advantage of it.","She's social and outgoing right now. Be the dad who shows up and engages.","She'll be great company this week. Make the effort to spend time together."]
   },
   hormones:'Estrogen is rising rapidly. The brain becomes more alert, creative, and socially confident. She feels lighter, more optimistic, and genuinely energised. This is her natural high point in the cycle.',
   mood:'Happy, energetic, open-minded, extroverted. She\'s at her best and genuinely fun to be around.',
   dos_all:['âœ… Plan dates, outings, and new experiences','âœ… Have important conversations â€” future plans, big topics','âœ… Try new restaurants, activities, or adventures','âœ… Be spontaneous and match her energy','âœ… Suggest social plans and follow through'],
   donts_all:['âŒ Don\'t waste this window being boring','âŒ Don\'t keep avoiding conversations you\'ve been putting off','âŒ Don\'t take her great mood for granted','âŒ Don\'t bail on plans â€” she\'s organised and excited right now'],
   notsay_romantic:["\"I don't feel like going out\"","\"Let's just stay home again\"","\"We can talk about that later\"","\"I forgot to make a reservation\"","\"I'm too tired\" (when you're just being lazy)"],
   notsay_friend:["\"I can't make it again, sorry\"","\"Maybe next time\"","\"I'm too busy\""],
   notsay_family:["\"I've been meaning to call\"","\"Let's catch up soon\" (without following through)","\"I'm too busy this week\""],
   winpoints_romantic:['ğŸ‰ Plan a spontaneous adventure or fun outing','ğŸ’¬ Have that conversation you\'ve been avoiding â€” she\'s receptive','ğŸ½ï¸ Book a new restaurant she\'s wanted to try','ğŸ­ Buy tickets to a show, concert, or event','ğŸï¸ Plan a day trip or weekend away and actually book it','ğŸ¨ Sign up for a class or experience together','ğŸ“¸ Take her somewhere photo-worthy','ğŸŒ† Explore a new part of the city together','ğŸ¥‚ Surprise her with a proper date night','ğŸŒ¸ Buy flowers just because â€” no occasion needed'],
   winpoints_friend:['ğŸ“… Actually commit to plans and follow through','ğŸ½ï¸ Book that lunch or dinner you\'ve been talking about','ğŸ­ Suggest something fun â€” escape room, event, activity','ğŸ’¬ Have a proper catch-up â€” she\'s in a great headspace','ğŸƒ Suggest an active outing â€” walk, hike, class together'],
   winpoints_family:['ğŸ“ Call and suggest a proper catch-up','ğŸ½ï¸ Take her out for lunch or dinner','ğŸ¯ Plan an activity you can do together','ğŸ’¬ Have a meaningful conversation â€” she\'s sharp and engaged','ğŸš— Offer to take her somewhere she\'s been wanting to go']
  },
  {name:'Ovulation',days:[13,14,15],emoji:'ğŸ”¥',color:'linear-gradient(135deg,#3d1a00,#7a3500)',
   oneliners:{
     wife:["Bro. She is at PEAK everything right now. Confidence, energy, libido â€” all maxed out. Clear your calendar tonight. You're welcome.","This is the window, mate. She's glowing, she knows it, and she wants connection. Don't be the guy who misses this.","Estrogen has peaked. Libido is dialled up. She looks incredible and she feels it. Plan something romantic. Tonight.","She's literally at her biological best right now. Be the husband who shows up, shows off, and shows out tonight.","Peak week. She's magnetic, confident, and looking for real connection. Step up, plan something, and be fully present."],
     girlfriend:["Bro, she is radiating right now. Confidence is maxed, libido is high, she looks incredible. Plan a proper date. Tonight.","This is her prime window. She's glowing, social, and wants real connection. Don't miss it.","She's at peak energy and confidence. Be the guy who matches her intensity this week.","She feels amazing right now â€” make sure she knows you notice. A real date. Real effort.","She's magnetic this week. The question is whether you're showing up at the level she deserves."],
     friend:["She's in her element right now â€” confident, social, and full of energy. Great time to make plans or reconnect.","She's feeling herself this week. Good time for a fun group outing or catch-up.","She's at her most social and energetic. Make plans. She'll be great company.","High energy, high confidence. She'll be the life of the party this week â€” include her in plans.","She's glowing this week, mate. Good time for a proper hang or group outing."],
     mom:["Your mum's in great form this week â€” confident, energetic, social. Great time to call or plan something together.","She's feeling good and full of energy. Perfect time to take her out or spend quality time.","She's at her most engaged and sociable this week. Don't let it pass without reaching out.","Call her this week. She's in great spirits and would love to hear from you.","She's sharp and social right now. Perfect week for a lunch date or family get-together."],
     daughter:["She's confident and full of energy this week, dad. Great time for a fun activity together.","She's in her element right now â€” engage with her, celebrate that energy, be present.","High confidence, high energy. Be the dad who shows up and matches her enthusiasm.","She's feeling great this week. Good time for a quality father-daughter moment.","She's bright and energetic right now. Be present and engaged â€” she'll remember it."]
   },
   hormones:'Estrogen peaks and LH surges, triggering egg release. This is her most fertile window and the point of highest libido, social confidence, and physical energy. Her voice, appearance, and mood are all at their peak.',
   mood:'Confident, flirty, energetic, passionate. She feels and looks her absolute best.',
   dos_all:['âœ… Plan something genuinely enjoyable together','âœ… Compliment her â€” be specific and sincere','âœ… Be fully present â€” phone away','âœ… Be affectionate and attentive','âœ… Make an effort with your appearance too'],
   donts_all:['âŒ Don\'t be distracted on dates','âŒ Don\'t bring up stressful topics','âŒ Don\'t cancel or reschedule without very good reason'],
   notsay_romantic:["\"I'm too tired tonight\"","\"Can we talk about the credit card bill?\"","\"I'm just gonna hang with the guys\"","\"You look tired\" (she doesn't)","\"I forgot we had plans\""],
   notsay_friend:["\"I can't make it\"","\"I'm busy this week\""],
   notsay_family:["\"I've been meaning to visit\"","\"Let me check my schedule\""],
   winpoints_romantic:['ğŸ’ Buy her flowers â€” unexpected, no occasion needed','ğŸ“¸ Take her somewhere she\'ll want to post about','ğŸ‘— Compliment how she looks â€” specific and genuine','ğŸŒ™ Plan an intentional romantic evening','ğŸ’ Small jewellery or meaningful gift','ğŸ¥‚ Book a proper dinner â€” no excuses','ğŸ’Œ Handwritten note about what you love about her','ğŸŒ¹ Send flowers to her work â€” make her feel celebrated','ğŸ¶ Make her a playlist of songs that remind you of her','ğŸ§´ Book her a spa treatment as a surprise'],
   winpoints_friend:['ğŸ‰ Suggest a group outing or event â€” she\'ll be the life of it','ğŸ“¸ Plan something fun and worth a memory','ğŸ’¬ Celebrate her wins â€” tell her she\'s doing great','ğŸ½ï¸ Book that dinner you\'ve been meaning to do','ğŸ­ Suggest something fun and social â€” she\'s up for it'],
   winpoints_family:['ğŸŒº Take her somewhere special â€” she\'s in great form','ğŸ“ Call and tell her you\'re proud of her or thinking of her','ğŸ Small thoughtful gift out of nowhere','ğŸ½ï¸ Family meal or special occasion â€” make it happen','ğŸ’¬ Tell her something meaningful â€” she\'ll carry it']
  },
  {name:'Early Luteal',days:[16,17,18],emoji:'ğŸ˜Œ',color:'linear-gradient(135deg,#2a1a3d,#4a2a6b)',
   oneliners:{
     wife:["The high is fading, mate. She's shifting inward. Slow down, pay attention, and show up with small acts of care.","Less flash, more feeling this week. Quality time over grand gestures.","She wants depth, not distraction. Be present and genuinely attentive today.","She's winding down a bit. Create calm, not chaos. Small and consistent is the move.","Pay attention to what she's not saying as much as what she is. She needs connection, not performance."],
     girlfriend:["She's coming down from her peak â€” be warm, attentive, and low-maintenance.","She wants calm connection this week. Put your phone down and actually be present.","Less big plans, more quality moments. She'll appreciate the shift.","She might be a bit quieter â€” don't read into it, just be there.","Small, consistent gestures win big this week. Think less, do more."],
     friend:["She might be a bit quieter this week â€” check in without pushing.","Good week for a low-key catch-up rather than something big and social.","She's turning inward a bit. A thoughtful message goes a long way.","Don't over-plan. Suggest something easy and let her decide.","She'll appreciate a calm, easy catch-up more than a big night out right now."],
     mom:["She might be a bit more reflective this week â€” good time for a meaningful call.","Low-key quality time is the move. Take her for a quiet coffee or lunch.","She's calmer and more inward-facing. Perfect time for a genuine heart-to-heart.","Call her just to chat. Not about logistics â€” just to connect.","Be the kid who shows up with warmth this week. She'll appreciate it more than you know."],
     daughter:["She might be a bit quieter this week, dad. Don't push â€” just be available and warm.","Check in without pressuring. Let her know you're there.","She's more reflective right now. Good time for a gentle, no-pressure conversation.","Be a calm, steady presence. That's what she needs from you this week.","Easy, no-pressure time together. No big topics. Just warmth."]
   },
   hormones:'Progesterone begins rising after ovulation. The peak energy starts to ease. She may become more reflective and inward-focused, craving calmer, more intimate connection over big social situations.',
   mood:'Calmer, slightly more sensitive, turning inward. Wants quiet connection over big events.',
   dos_all:['âœ… Focus on quality, low-key time together','âœ… Be a good listener â€” she may be more reflective','âœ… Give sincere compliments about who she is','âœ… Check in on how she\'s feeling','âœ… Take over responsibilities without announcing it'],
   donts_all:['âŒ Don\'t fill the week with loud social plans','âŒ Don\'t be dismissive if she seems quieter','âŒ Don\'t neglect small acts of warmth and affection','âŒ Don\'t make her feel like she needs to perform or be "on"'],
   notsay_romantic:["\"What's wrong with you lately?\"","\"You seem off\"","\"I need you to be more fun\"","\"Stop being so sensitive\"","\"Why are you being so quiet?\""],
   notsay_friend:["\"You're being quiet lately\"","\"Is everything okay?\" (repeatedly)","\"You seem different\""],
   notsay_family:["\"You seem down\"","\"Are you okay?\" (pushed repeatedly)","\"You're being quiet\""],
   winpoints_romantic:['ğŸ³ Cook her favourite meal without being asked','ğŸ’Œ Send a thoughtful genuine text mid-day','ğŸ›‹ï¸ Cosy night in â€” candles, her choice, zero agenda','ğŸŒ¹ Small gift â€” thoughtful beats expensive','ğŸ§– Long massage â€” back, shoulders, feet','ğŸ•¯ï¸ Light candles and dim the lights at home','ğŸ“– Buy the book she\'s been mentioning','ğŸ§º Do the laundry, fold it, put it away','ğŸµ Make her favourite drink without asking','ğŸ¤— Long hug â€” hold it, don\'t let go first'],
   winpoints_friend:['ğŸ“± Send a genuine "thinking of you" message','â˜• Suggest a low-key coffee or catch-up','ğŸ’¬ Ask how she\'s really doing â€” and listen','ğŸ¬ Suggest a low-key movie or TV catch-up','ğŸŒ¸ Drop off a small treat if you\'re nearby'],
   winpoints_family:['ğŸ“ Call just to chat â€” no agenda','ğŸ½ï¸ Suggest a quiet meal together','ğŸ’¬ Have a calm, genuine conversation','ğŸŒº Drop off flowers or a small treat','ğŸ§¹ Help out around the house or with tasks']
  },
  {name:'PMS Phase',days:[19,20,21,22,23,24,25,26,27,28],emoji:'âš ï¸',color:'linear-gradient(135deg,#2a1a00,#4a2e00)',
   oneliners:{
     wife:["Bro, PMS week has entered the chat. Keep your head down, your mouth shut, and come home with snacks. You've got this.","This is the week that separates the men from the boys, mate. Stay calm, stay useful, and don't take the bait.","Her serotonin is in the basement and her patience is running thin. Your job: be easy to be around. That's it.","PMS is not her being dramatic. Her brain chemistry is literally different this week. Adjust accordingly.","Danger zone, mate. No big conversations, no stupid questions, no 'are you on your period?' Just snacks and patience."],
     girlfriend:["Bro, tread carefully this week. She's not herself hormonally and the last thing you need is to be the guy who made it worse.","PMS week. Your move: snacks, patience, and zero drama. Keep it simple.","Her tolerance is lower than usual and that's okay. Be the boyfriend who makes this week easier, not harder.","Don't take the bait this week. Stay steady. The version of her you love will be back shortly.","This is where relationships are tested. Be the guy who shows up calmly and without agenda."],
     friend:["Your girl friend might be a bit sharp this week â€” don't take it personally and don't escalate.","Give her a bit of extra patience this week. She's dealing with a lot hormonally.","Don't push, don't prod, don't plan big things. Just be a low-maintenance, high-quality friend.","Check in gently but don't crowd her. She'll appreciate the space.","Be a steady, drama-free presence this week. That's what a real mate does."],
     mom:["Your mum might be a bit sharp or emotional this week â€” be patient and don't add to her load.","She's dealing with a lot hormonally right now. Be the helpful, understanding son she deserves.","Don't trigger arguments this week. Help out, be kind, and check in on her.","Be the son who reduces her stress this week, not the one who adds to it.","Help around the house. Call her. Be present. She needs her load lightened right now."],
     daughter:["She might be emotional or irritable this week, dad. Don't take it personally â€” and definitely don't comment on it.","Be patient, be kind, and absolutely do not say anything about her mood or hormones. Just be supportive.","She needs a calm, understanding presence this week. Be that for her.","Don't push her buttons this week. Low pressure, high warmth. That's the play.","Be the safe, steady dad she can rely on. No teasing, no commentary. Just love."]
   },
   hormones:'Progesterone drops sharply. Estrogen fluctuates. Serotonin dips significantly, affecting mood regulation. Bloating, headaches, fatigue, and emotional sensitivity are all real physiological symptoms.',
   mood:'Irritable, emotionally heightened, possibly anxious or low. Small things may feel disproportionately big.',
   dos_all:['âœ… Listen without problem-solving','âœ… Give space when needed â€” read the signals','âœ… Show up with small consistent acts of care','âœ… Validate her feelings','âœ… Keep shared spaces tidy â€” clutter adds to stress','âœ… Handle your responsibilities without reminders'],
   donts_all:['âŒ Don\'t pick fights or bring up unresolved issues','âŒ Don\'t discuss budgets, big plans, or guys trips','âŒ Don\'t suggest she\'s overreacting','âŒ Don\'t withdraw or go silent without checking in','âŒ Don\'t make her deal with life admin alone'],
   notsay_romantic:["\"You're being irrational\"","\"Is it that time of the month again?\"","\"You need to calm down\"","\"You're overreacting\"","\"Have you gained weight?\" (NEVER. EVER.)","\"You're so emotional lately\"","\"Can we talk about this rationally?\""],
   notsay_friend:["\"You're being really difficult lately\"","\"I can't handle you when you're like this\"","\"What's your problem?\"","\"Drama as usual\""],
   notsay_family:["\"You're always like this\"","\"What's wrong with you?\"","\"Stop being so emotional\"","\"You're being dramatic\""],
   winpoints_romantic:['ğŸ§˜ Give her space without making it cold','ğŸ• Order her favourite food â€” no discussion needed','ğŸ’† Massage with zero expectation','ğŸ Small thoughtful gift â€” lands huge right now','ğŸ§¹ Clean the house proactively and quietly','ğŸ›’ Do the grocery shop and get her snacks','ğŸ« Stock comfort foods without being asked','ğŸ“º Queue her comfort show, sit with her','ğŸŒº Flowers â€” seriously, it\'s a cheat code this week','ğŸ’¬ Say "I hear you" and stop there â€” no "but"'],
   winpoints_friend:['ğŸ“± Low-key check-in message â€” no pressure','ğŸ• Offer to grab food together','ğŸ’¬ Be a calm, drama-free presence','ğŸ¬ Suggest a chill hang with no agenda','ğŸ¤ Just be easy to be around this week'],
   winpoints_family:['ğŸ§¹ Help with chores without being asked','ğŸ“ Call and just listen','ğŸ² Cook or bring a meal','ğŸ’Š Make sure she has what she needs','ğŸŒº Small flowers or treat â€” it matters']
  }
];

const BAR_COLORS={'Menstruation':'#cc0033','Follicular Phase':'#0088cc','Ovulation':'#ff6600','Early Luteal':'#6633cc','PMS Phase':'#cc6600'};

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let auth,db,currentUser=null,userData={};

// â”€â”€ Firebase â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
firebase.initializeApp({apiKey:'AIzaSyBHZimT1Npa5gwzCk2KDQP4kS0R4IC2qRI',authDomain:'guys-guide-to-ladies.firebaseapp.com',projectId:'guys-guide-to-ladies',storageBucket:'guys-guide-to-ladies.firebasestorage.app',messagingSenderId:'883845849328',appId:'1:883845849328:web:e24f311dc30ef1b6b52235'});
auth=firebase.auth(); db=firebase.firestore();

const $=id=>document.getElementById(id);
const showErr=msg=>{const e=$('auth-err');e.textContent=msg;e.style.display='block';};
const hideErr=()=>{$('auth-err').style.display='none';};
function friendlyErr(c){return({'auth/user-not-found':'No account found.','auth/wrong-password':'Incorrect password.','auth/invalid-credential':'Incorrect email or password.','auth/email-already-in-use':'Email already in use.','auth/weak-password':'Password must be 6+ characters.','auth/invalid-email':'Invalid email address.','auth/popup-closed-by-user':'Cancelled.','auth/network-request-failed':'Network error.'})[c]||'Error: '+c;}

function getPhase(day,len){const d=Math.round(Math.min(day,len)/len*28);for(const p of PHASES)if(p.days.includes(d))return p;return PHASES[4];}
function calcLearned(){const h=(userData.history||[]).map(d=>new Date(d+'T12:00:00')).sort((a,b)=>a-b);if(h.length<2)return null;const diffs=[];for(let i=1;i<h.length;i++)diffs.push(Math.round((h[i]-h[i-1])/86400000));const v=diffs.filter(d=>d>=21&&d<=45);return v.length?Math.round(v.reduce((a,b)=>a+b,0)/v.length):null;}

function getTodayInfo(){
  if(!userData.periodStart)return null;
  const len=parseInt(userData.cycleLength)||28;
  const today=new Date();today.setHours(0,0,0,0);
  const sd=new Date(userData.periodStart+'T12:00:00');sd.setHours(0,0,0,0);
  let day=(Math.floor((today-sd)/86400000)%len)+1;
  if(day<1)day=1;
  const phase=getPhase(day,len);
  const rel=userData.relationship||'girlfriend';
  const rng=seedRand(dailySeed()*100+day);
  const oneliners=phase.oneliners[rel]||phase.oneliners.girlfriend;
  const oneliner=pickOne(oneliners,rng);
  const wpPool=isRomantic(rel)?phase.winpoints_romantic:(rel==='friend'?phase.winpoints_friend:phase.winpoints_family);
  const winpoints=pickN(wpPool,4,rng);
  const nsPool=isRomantic(rel)?phase.notsay_romantic:(rel==='friend'?phase.notsay_friend:phase.notsay_family);
  const notsay=pickOne(nsPool,seedRand(dailySeed()*100+day+999));
  return{phase,day,len,oneliner,winpoints,notsay,rel};
}

async function loadUserData(){const snap=await db.collection('users').doc(currentUser.uid).get();userData=snap.exists?snap.data():{};}
async function saveUserData(u){userData={...userData,...u};await db.collection('users').doc(currentUser.uid).set(userData,{merge:true});}

function switchTab(t){hideErr();$('tab-login').classList.toggle('active',t==='login');$('tab-signup').classList.toggle('active',t==='signup');$('login-form').style.display=t==='login'?'block':'none';$('signup-form').style.display=t==='signup'?'block':'none';}
async function doLogin(){hideErr();const e=$('login-email').value.trim(),p=$('login-pass').value;if(!e||!p){showErr('Please enter email and password.');return;}$('btn-login').disabled=true;$('btn-login').textContent='Signing in...';try{await auth.signInWithEmailAndPassword(e,p);}catch(er){showErr(friendlyErr(er.code));$('btn-login').disabled=false;$('btn-login').textContent='Sign In';}}
async function doSignup(){hideErr();const n=$('signup-name').value.trim()||'Guy',e=$('signup-email').value.trim(),p=$('signup-pass').value;if(!e||!p){showErr('Fill in all fields.');return;}$('btn-signup').disabled=true;$('btn-signup').textContent='Creating...';try{const c=await auth.createUserWithEmailAndPassword(e,p);await c.user.updateProfile({displayName:n});await db.collection('users').doc(c.user.uid).set({name:n,email:e,createdAt:new Date().toISOString()});}catch(er){showErr(friendlyErr(er.code));$('btn-signup').disabled=false;$('btn-signup').textContent='Create Account';}}
async function doGoogle(){hideErr();try{const pr=new firebase.auth.GoogleAuthProvider();const c=await auth.signInWithPopup(pr);const r=db.collection('users').doc(c.user.uid);const s=await r.get();if(!s.exists)await r.set({name:c.user.displayName||'Guy',email:c.user.email,createdAt:new Date().toISOString()});}catch(er){showErr(friendlyErr(er.code));}}
async function doSignOut(){await auth.signOut();userData={};$('auth-screen').style.display='flex';}

auth.onAuthStateChanged(async u=>{if(u){currentUser=u;$('auth-screen').style.display='none';await loadUserData();renderDashboard();}else{currentUser=null;$('auth-screen').style.display='flex';}});

// â”€â”€ Menopause Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderMenoDashboard(stage){
  const dash=$('dashboard');
  const name=userData.herName||'Her';
  const rel=userData.relationship||'wife';
  const rng=seedRand(dailySeed()+42);
  const isPost=stage==='postmenopause';
  const focusData=isPost?null:pickOne(MENO_FOCUSES,rng);
  const wps=isPost?POSTMENO_DATA.winpoints:(isRomantic(rel)?focusData.winpoints_all:focusData.winpoints_all.slice(0,5));
  const winpoints=pickN(wps,4,rng);

  if(isPost){
    dash.innerHTML=`
      <div class="user-bar"><span>ğŸ‘¤ <strong>${currentUser.displayName||currentUser.email}</strong></span><button class="btn btn-outline btn-sm" id="so-btn">Sign Out</button></div>
      <div class="phase-banner" style="background:linear-gradient(135deg,#1a1a2e,#2a1a3d)">
        <span class="emoji">âœ¨</span>
        <div class="rel-badge">${relLabel(rel)}</div>
        <h2>Tracking ${name}</h2>
        <h3>Post-Menopause</h3>
        <div class="one-liner">"She's been through the storm and come out the other side. She deserves a guy who shows up â€” consistently, thoughtfully, and without being asked."</div>
      </div>
      <div class="overview-card"><h4>ğŸŒ¿ The Big Picture</h4><p style="color:#ccc;line-height:1.6;font-size:.95em">${POSTMENO_DATA.overview}</p></div>
      <div class="card"><h4>âœ… How to Show Up</h4><ul class="tip-list">${POSTMENO_DATA.tips.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card dont-say"><h4>ğŸš« What to Avoid</h4><ul class="tip-list">${POSTMENO_DATA.donts.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card win-points"><h4>ğŸ† Win Points Today</h4><ul class="tip-list">${winpoints.map(w=>`<li>${w}</li>`).join('')}</ul></div>
      <button class="btn btn-outline" id="go-setup2" style="margin-bottom:20px">âš™ï¸ Update Info</button>`;
  } else {
    dash.innerHTML=`
      <div class="user-bar"><span>ğŸ‘¤ <strong>${currentUser.displayName||currentUser.email}</strong></span><button class="btn btn-outline btn-sm" id="so-btn">Sign Out</button></div>
      <div class="focus-card" style="background:${focusData.color}">
        <div class="focus-emoji">${focusData.emoji}</div>
        <div class="rel-badge">${relLabel(rel)} Â· ${stageLabel(stage)}</div>
        <h2 style="font-size:1em;text-transform:uppercase;letter-spacing:2px;opacity:.8;margin-bottom:4px">Tracking ${name}</h2>
        <h3>${focusData.name}</h3>
        <div class="one-liner" style="font-size:.9em">"${stage==='menopause'?'She\'s navigating one of the biggest hormonal transitions of her life. Be the guy who makes it easier, not harder â€” every single day.':'Perimenopause turns up the volume on everything. More patience, more care, more showing up. This is where you earn it.'}"</div>
      </div>
      <div class="warning-banner">âš ï¸ <strong>${stage==='perimenopause'?'Perimenopause':'Menopause'}:</strong> ${stage==='perimenopause'?'Cycles may be irregular and symptoms can be more intense than usual. Use cycle tracking as a guide, not a guarantee.':'The cycle tracker is less relevant at this stage. Use the daily hormonal climate report above to guide your approach.'}</div>
      <div class="overview-card"><h4>ğŸŒ¿ Steady Overview â€” What\'s Always True</h4><p style="color:#ccc;line-height:1.6;font-size:.95em">${POSTMENO_DATA.overview.replace('settled','shifting')}</p></div>
      <div class="card"><h4>ğŸ¯ Today\'s Focus: ${focusData.name}</h4><p style="color:#ccc;line-height:1.6;font-size:.95em">${focusData.overview}</p></div>
      <div class="card"><h4>âœ… What To Do Today</h4><ul class="tip-list">${focusData.tips.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card dont-say"><h4>ğŸš« What To Avoid</h4><ul class="tip-list">${focusData.donts.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card win-points"><h4>ğŸ† Win Points Today</h4><ul class="tip-list">${winpoints.map(w=>`<li>${w}</li>`).join('')}</ul></div>
      <button class="btn btn-outline" id="go-setup2" style="margin-bottom:20px">âš™ï¸ Update Info</button>`;
  }
  $('so-btn').onclick=doSignOut;
  $('go-setup2').onclick=()=>showPage('setup');
}

// â”€â”€ Main Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderDashboard(){
  const dash=$('dashboard');
  const stage=getLifeStage(userData.age||30);
  if(stage==='menopause'||stage==='postmenopause'||stage==='perimenopause'){renderMenoDashboard(stage);return;}
  const info=getTodayInfo();
  const name=userData.herName||'Her';
  const rel=userData.relationship||'girlfriend';
  if(!info){
    dash.innerHTML=`<div class="no-data"><div class="big">ğŸ“‹</div><h3>No Cycle Tracked Yet</h3><p>Head to Setup to enter her info.</p><button class="btn" id="go-setup">Get Started</button></div>`;
    $('go-setup').onclick=()=>showPage('setup');return;
  }
  const{phase,day,len,oneliner,winpoints,notsay}=info;
  const pct=Math.round(day/len*100),bc=BAR_COLORS[phase.name]||'#e94560';
  const teenNote=stage==='teen'?'<div class="warning-banner">ğŸ‘§ <strong>Teen cycle:</strong> Cycles are often irregular in the early years â€” use this as a guide rather than a precise tracker. Be extra patient and understanding.</div>':'';
  dash.innerHTML=`
    <div class="user-bar"><span>ğŸ‘¤ <strong>${currentUser.displayName||currentUser.email}</strong></span><button class="btn btn-outline btn-sm" id="so-btn">Sign Out</button></div>
    ${teenNote}
    <div class="phase-banner" style="background:${phase.color}">
      <span class="emoji">${phase.emoji}</span>
      <div class="rel-badge">${relLabel(rel)} Â· ${stageLabel(stage)}</div>
      <h2>Tracking ${name}</h2><h3>${phase.name}</h3>
      <div class="day-badge">Day ${day} of ${len}</div>
      <div class="one-liner">"${oneliner}"</div>
      <div class="cycle-bar"><div class="cycle-bar-fill" style="width:${pct}%;background:${bc}"></div></div>
      <div class="cycle-meta"><span>Day 1</span><span>${pct}% through cycle</span><span>Day ${len}</span></div>
    </div>
    <div class="card"><h4>ğŸ§¬ What's Happening Hormonally</h4><p>${phase.hormones}</p></div>
    <div class="card"><h4>ğŸ­ Mood & Energy Forecast</h4><p>${phase.mood}</p></div>
    <div class="card"><h4>âœ… Your Action Plan Today</h4><ul class="tip-list">${phase.dos_all.map(d=>`<li>${d}</li>`).join('')}</ul></div>
    <div class="card"><h4>ğŸš« Things to Avoid Today</h4><ul class="tip-list">${phase.donts_all.map(d=>`<li>${d}</li>`).join('')}</ul></div>
    <div class="card dont-say"><h4>ğŸ¤ What NOT to Say Right Now</h4><div class="dont-item">${notsay}</div></div>
    <div class="card win-points"><h4>ğŸ† Win Points â€” Do These Today</h4><ul class="tip-list">${winpoints.map(w=>`<li>${w}</li>`).join('')}</ul></div>
    <button class="btn btn-outline" id="go-setup2" style="margin-bottom:20px">âš™ï¸ Update Info</button>`;
  $('so-btn').onclick=doSignOut;
  $('go-setup2').onclick=()=>showPage('setup');
}

// â”€â”€ Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const EMAIL_TEMPLATE=`<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body style="margin:0;padding:0;background:#0f0f0f;font-family:'Segoe UI',Arial,sans-serif;"><table width="100%" cellpadding="0" cellspacing="0" style="background:#0f0f0f;padding:30px 20px;"><tr><td align="center"><table width="100%" style="max-width:560px;"><tr><td style="background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:16px 16px 0 0;padding:28px 30px;text-align:center;border-bottom:3px solid #e94560;"><div style="font-size:36px;">ğŸ¯</div><div style="color:#fff;font-size:22px;font-weight:900;">GUY'S GUIDE TO <span style="color:#e94560;">LADIES</span></div><div style="color:#888;font-size:13px;margin-top:4px;">Your Daily Relationship Intelligence</div></td></tr><tr><td style="background:#1a1a2e;padding:24px 30px;text-align:center;"><div style="font-size:48px;">{{phase_emoji}}</div><div style="color:#aaa;font-size:11px;text-transform:uppercase;letter-spacing:2px;">Day {{day}} of {{cycle_length}}</div><div style="color:#fff;font-size:24px;font-weight:900;margin:6px 0;">{{phase}}</div><div style="background:rgba(255,255,255,0.07);border-radius:8px;padding:10px 16px;color:#ddd;font-size:14px;font-style:italic;">"{{one_liner}}"</div></td></tr><tr><td style="background:#111;padding:20px 30px;border-left:4px solid #e94560;"><div style="color:#e94560;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">ğŸ§¬ What's Happening Hormonally</div><div style="color:#ccc;font-size:14px;line-height:1.7;">{{hormones}}</div></td></tr><tr><td style="background:#0f0f0f;padding:20px 30px;border-left:4px solid #6633cc;"><div style="color:#9966ff;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">ğŸ­ Mood & Energy Today</div><div style="color:#ccc;font-size:14px;line-height:1.7;">{{mood}}</div></td></tr><tr><td style="background:#0a1a0a;padding:20px 30px;border-left:4px solid #44cc44;"><div style="color:#44cc44;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">ğŸ† Win Move Today</div><div style="color:#ccc;font-size:15px;line-height:1.7;">{{tip}}</div></td></tr><tr><td style="background:#1a0a0a;padding:20px 30px;border-left:4px solid #ff4444;"><div style="color:#ff4444;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:10px;">ğŸ¤ Do NOT Say This</div><div style="background:#2a1111;border-radius:8px;padding:12px 16px;color:#ffaaaa;font-size:14px;font-style:italic;">ğŸš« {{not_say}}</div></td></tr><tr><td style="background:#0a0a0a;border-radius:0 0 16px 16px;padding:20px 30px;text-align:center;border-top:1px solid #222;"><div style="color:#444;font-size:12px;">Made with â¤ï¸ for the guys who actually give a damn</div></td></tr></table></td></tr></table></body></html>`;

function renderSetup(){
  const learned=calcLearned(),h=(userData.history||[]).sort((a,b)=>new Date(b)-new Date(a));
  const rel=userData.relationship||'girlfriend';
  const age=userData.age||'';
  const stage=getLifeStage(age||30);
  const isMeno=stage==='menopause'||stage==='postmenopause'||stage==='perimenopause';
  $('setup').innerHTML=`
    <div class="setup-card">
      <h2>Her Profile</h2>
      <p style="color:#888;margin-bottom:20px;font-size:.9em">Syncs across all your devices â˜ï¸</p>
      <label>Her Name</label><input id="her-name" value="${userData.herName||''}" placeholder="e.g. Sarah"/>
      <label>Relationship</label>
      <select id="her-rel">
        <option value="wife" ${rel==='wife'?'selected':''}>ğŸ‘° Wife</option>
        <option value="girlfriend" ${rel==='girlfriend'?'selected':''}>ğŸ’‘ Girlfriend</option>
        <option value="friend" ${rel==='friend'?'selected':''}>ğŸ‘¯ Friend</option>
        <option value="mom" ${rel==='mom'?'selected':''}>ğŸ’ Mom</option>
        <option value="daughter" ${rel==='daughter'?'selected':''}>ğŸŒŸ Daughter</option>
      </select>
      <label>Her Age</label>
      <input type="number" id="her-age" value="${age}" placeholder="e.g. 34" min="13" max="80"/>
      <div style="background:#1a1a0a;border:1px solid #444;border-radius:8px;padding:10px 14px;font-size:.82em;color:#aaa;margin-bottom:16px;">
        ğŸ“Š Life stage detected: <strong style="color:#fff">${stageLabel(stage)}</strong>${isMeno?' â€” cycle tracker replaced with hormonal climate dashboard':''}
      </div>
      ${!isMeno?`
      <label>First Day of Most Recent Period</label><input type="date" id="period-start" value="${userData.periodStart||''}"/>
      <label>Cycle Length (days)${learned?' <span class="tag">ğŸ“ˆ LEARNED</span>':''}</label>
      <input type="number" id="cycle-length" value="${learned||userData.cycleLength||28}" min="21" max="45"/>
      ${learned?`<div class="learned-badge">âœ… Auto-calculated from ${h.length} logged periods</div>`:''}
      `:'<p style="color:#888;font-size:.85em;margin-bottom:16px;padding:10px;background:#1a1a1a;border-radius:8px;">ğŸ’œ Cycle tracking is replaced with a daily Hormonal Climate Dashboard for this life stage.</p>'}
      <button class="btn" id="save-btn">ğŸ’¾ Save Profile</button>
      ${!isMeno?`
      <hr>
      <div class="section-title">ğŸ“… Log New Period Start</div>
      <p style="color:#888;font-size:.85em;margin-bottom:14px">Log each new period so the app learns her real cycle length.</p>
      <label>New Period Start Date</label><input type="date" id="new-period-date"/>
      <button class="btn btn-outline" id="log-btn">â• Log Period Start</button>
      ${h.length?`
        <div class="section-title">ğŸ“… Period History (${h.length} logged)</div>
        ${learned?`<div class="learned-badge">ğŸ“ˆ Learned cycle: <strong>${learned} days</strong></div>`:''}
        ${h.map(d=>`<div class="history-item"><span>ğŸ”´ ${new Date(d+'T12:00:00').toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'})}</span><button class="del" data-date="${d}">ğŸ—‘ï¸</button></div>`).join('')}
      `:''}
      `:''}
      <hr>
      <div class="section-title">ğŸ”” Browser Notifications</div>
      <button class="btn btn-green" id="notif-btn">ğŸ”” Enable Browser Notifications</button>
      <hr>
      <div class="section-title">ğŸ“§ Email Reminders (EmailJS)</div>
      <div class="emailjs-info">1. Sign up free at <a href="https://emailjs.com" target="_blank">emailjs.com</a><br>2. Create an Email Service (Gmail works great)<br>3. Create a Template â€” paste our pre-built code using the button below<br>4. Enter your IDs below</div>
      <button class="btn btn-outline" id="copy-template-btn" style="margin-bottom:16px">ğŸ“‹ Copy Email Template Code</button>
      <label>Your Email</label><input type="email" id="notify-email" value="${userData.notifyEmail||''}" placeholder="you@example.com"/>
      <label>EmailJS Service ID</label><input id="ejs-svc" value="${userData.ejsSvc||''}" placeholder="service_xxxxxxx"/>
      <label>EmailJS Template ID</label><input id="ejs-tmpl" value="${userData.ejsTmpl||''}" placeholder="template_xxxxxxx"/>
      <label>EmailJS Public Key</label><input id="ejs-key" value="${userData.ejsKey||''}" placeholder="xxxxxxxxxxxxxx"/>
      <button class="btn btn-green" id="save-email-btn">ğŸ“§ Save Email Settings</button>
      <button class="btn btn-outline" id="test-email-btn">ğŸ§ª Send Test Email</button>
      <hr>
      <button class="btn btn-outline" id="so-btn2">ğŸšª Sign Out</button>
    </div>`;

  $('save-btn').onclick=async()=>{
    const herName=$('her-name').value||'Her';
    const relationship=$('her-rel').value;
    const age=parseInt($('her-age').value)||30;
    const st=getLifeStage(age);
    const isMenoNow=st==='menopause'||st==='postmenopause'||st==='perimenopause';
    const updates={herName,relationship,age};
    if(!isMenoNow){
      const periodStart=$('period-start').value;
      const cycleLength=parseInt($('cycle-length').value)||28;
      if(!periodStart){alert('Please enter the first day of her period.');return;}
      const h2=userData.history||[];
      if(!h2.includes(periodStart))h2.push(periodStart);
      updates.periodStart=periodStart;updates.cycleLength=cycleLength;updates.history=h2;
    }
    await saveUserData(updates);
    alert('âœ… Profile saved and synced!');showPage('dashboard');
  };

  const logBtn=$('log-btn');
  if(logBtn) logBtn.onclick=async()=>{
    const d=$('new-period-date').value;
    if(!d){alert('Please enter a date.');return;}
    const h2=userData.history||[];
    if(!h2.includes(d))h2.push(d);
    const sorted=[...h2].sort((a,b)=>new Date(b)-new Date(a));
    const lrn=calcLearned();const upd={history:h2,periodStart:sorted[0]};
    if(lrn)upd.cycleLength=lrn;
    await saveUserData(upd);
    alert(`âœ… Period logged!${lrn?`\nğŸ“ˆ Learned cycle: ${lrn} days`:''}`);renderSetup();
  };

  document.querySelectorAll('.del').forEach(btn=>{btn.onclick=async()=>{const h2=(userData.history||[]).filter(d=>d!==btn.dataset.date);await saveUserData({history:h2});renderSetup();};});

  $('notif-btn').onclick=()=>{
    if(!('Notification' in window)){alert('Not supported.');return;}
    Notification.requestPermission().then(p=>{if(p==='granted'){alert('âœ… Enabled!');}});
  };
  $('copy-template-btn').onclick=()=>{
    navigator.clipboard.writeText(EMAIL_TEMPLATE).then(()=>{
      const b=$('copy-template-btn');b.textContent='âœ… Copied!';b.style.borderColor='#44cc44';b.style.color='#44cc44';
      setTimeout(()=>{b.textContent='ğŸ“‹ Copy Email Template Code';b.style.borderColor='';b.style.color='';},3000);
    }).catch(()=>alert('Copy failed â€” try a different browser.'));
  };
  $('save-email-btn').onclick=async()=>{await saveUserData({notifyEmail:$('notify-email').value,ejsSvc:$('ejs-svc').value,ejsTmpl:$('ejs-tmpl').value,ejsKey:$('ejs-key').value});alert('âœ… Email settings saved!');};
  $('test-email-btn').onclick=()=>{
    const{notifyEmail:em,ejsSvc:sv,ejsTmpl:tm,ejsKey:ky}=userData;
    if(!em||!sv||!tm||!ky){alert('Fill in all EmailJS fields first.');return;}
    const i=getTodayInfo();if(!i){alert('Set up her cycle first.');return;}
    emailjs.init(ky);
    emailjs.send(sv,tm,{to_email:em,her_name:userData.herName||'Her',phase:i.phase.name,phase_emoji:i.phase.emoji,day:i.day,cycle_length:i.len,one_liner:i.oneliner,hormones:i.phase.hormones,mood:i.phase.mood,tip:i.winpoints[0],not_say:i.notsay,progress_pct:Math.round(i.day/i.len*100)})
      .then(()=>alert('âœ… Test email sent!'),e=>alert('âŒ '+JSON.stringify(e)));
  };
  $('so-btn2').onclick=doSignOut;
}

// â”€â”€ Reference â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderReference(){
  $('reference').innerHTML=`<h2 style="margin-bottom:16px;font-size:1.2em">ğŸ“– Complete Cycle Guide</h2>`+
    PHASES.map(p=>`<div class="phase-ref">
      <h3 style="margin-bottom:6px">${p.emoji} ${p.name} <span style="color:#666;font-size:.8em">(Days ${p.days[0]}â€“${p.days[p.days.length-1]})</span></h3>
      <p style="margin-bottom:8px;color:#888;font-size:.85em;line-height:1.5">${p.hormones}</p>
      <p style="color:#ff6666;font-size:.82em;margin-bottom:4px">ğŸš« e.g. ${p.notsay_romantic[0]}</p>
      <p style="color:#44cc44;font-size:.82em">ğŸ† e.g. ${p.winpoints_romantic[0]}</p>
    </div>`).join('')+
    `<h2 style="margin:24px 0 16px;font-size:1.2em">ğŸŒ¿ Menopause Stages</h2>`+
    [['ğŸŒ¿ Perimenopause (40â€“54)','Cycles become irregular and symptoms intensify. PMS with the volume turned up. Hot flashes, brain fog, mood swings, and sleep disruption. Track cycles as a rough guide only.'],
     ['ğŸŒ™ Menopause (51â€“54)','Periods have stopped. Significant hormonal shift. Daily hormonal climate dashboard replaces cycle tracking. Hot flashes, emotional intensity, fatigue, and brain fog are common.'],
     ['âœ¨ Post-Menopause (55+)','Hormones have settled at a new baseline. Lower estrogen effects persist â€” joint stiffness, mood shifts, energy fluctuation â€” but the intense transition is over.']
    ].map(([t,d])=>`<div class="phase-ref"><h3 style="margin-bottom:6px">${t}</h3><p style="color:#888;font-size:.85em;line-height:1.5">${d}</p></div>`).join('');
}

function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  $(id).classList.add('active');$('nav-'+id).classList.add('active');
  if(id==='dashboard')renderDashboard();
  if(id==='setup')renderSetup();
  if(id==='reference')renderReference();
}

$('tab-login').onclick=()=>switchTab('login');
$('tab-signup').onclick=()=>switchTab('signup');
$('btn-login').onclick=doLogin;$('btn-signup').onclick=doSignup;
$('btn-google-1').onclick=doGoogle;$('btn-google-2').onclick=doGoogle;
$('nav-dashboard').onclick=()=>showPage('dashboard');
$('nav-setup').onclick=()=>showPage('setup');
$('nav-reference').onclick=()=>showPage('reference');
</script>
</body>
</html>
