<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guy's Guide to Ladies</title>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Segoe UI',sans-serif;background:#0f0f0f;color:#fff;min-height:100vh}
  header{background:linear-gradient(135deg,#1a1a2e,#16213e);padding:20px;text-align:center;border-bottom:2px solid #e94560}
  header h1{font-size:1.8em;font-weight:900;letter-spacing:1px}
  header h1 span{color:#e94560}
  header p{color:#888;font-size:.85em;margin-top:4px}
  nav{display:flex;background:#1a1a1a;border-bottom:1px solid #222}
  nav button{flex:1;padding:12px;background:none;border:none;color:#888;font-size:.85em;cursor:pointer;font-weight:600;letter-spacing:.5px;text-transform:uppercase;transition:all .2s}
  nav button.active{color:#e94560;border-bottom:2px solid #e94560}
  nav button:hover{color:#fff}
  .page{display:none;padding:20px;max-width:600px;margin:0 auto}
  .page.active{display:block}
  #auth-screen{position:fixed;inset:0;background:#0f0f0f;z-index:100;display:flex;align-items:center;justify-content:center;padding:20px;overflow-y:auto}
  .auth-card{background:#1a1a2e;border-radius:20px;padding:36px 30px;width:100%;max-width:400px;text-align:center}
  .auth-card .logo{font-size:3em;margin-bottom:12px}
  .auth-card h2{font-size:1.5em;font-weight:900;margin-bottom:6px}
  .auth-card h2 span{color:#e94560}
  .auth-card>p{color:#888;font-size:.88em;margin-bottom:28px}
  .auth-tabs{display:flex;background:#0f0f0f;border-radius:10px;padding:4px;margin-bottom:24px}
  .auth-tab{flex:1;padding:10px;background:none;border:none;color:#888;cursor:pointer;border-radius:8px;font-weight:600;font-size:.9em;transition:all .2s}
  .auth-tab.active{background:#e94560;color:#fff}
  label{display:block;color:#aaa;font-size:.82em;margin-bottom:6px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;text-align:left}
  input,select{width:100%;padding:12px 16px;background:#0f0f0f;border:1px solid #333;border-radius:10px;color:#fff;font-size:1em;margin-bottom:16px;outline:none;font-family:inherit;appearance:none}
  input:focus,select:focus{border-color:#e94560}
  select option{background:#1a1a2e}
  .btn{background:#e94560;color:#fff;border:none;padding:14px 28px;border-radius:10px;font-size:1em;font-weight:700;cursor:pointer;width:100%;transition:background .2s;letter-spacing:.5px;margin-bottom:10px;display:block;font-family:inherit}
  .btn:hover{background:#c73652}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .btn-outline{background:transparent;border:2px solid #e94560;color:#e94560}
  .btn-outline:hover{background:#e94560;color:#fff}
  .btn-green{background:#1a6b1a;border:2px solid #44cc44;color:#44cc44}
  .btn-green:hover{background:#44cc44;color:#000}
  .btn-sm{padding:8px 16px;font-size:.85em;width:auto;display:inline-block}
  .err{background:#3d0000;border:1px solid #cc0033;border-radius:8px;padding:10px 14px;color:#ff8888;font-size:.85em;margin-bottom:14px;display:none;text-align:left}
  .phase-banner{border-radius:16px;padding:24px;margin-bottom:16px;text-align:center}
  .phase-banner h2{font-size:1em;text-transform:uppercase;letter-spacing:2px;opacity:.8}
  .phase-banner h3{font-size:2em;font-weight:900;margin:6px 0 4px}
  .phase-banner .day-badge{font-size:.9em;opacity:.7;margin-bottom:6px}
  .phase-banner .one-liner{font-size:.95em;font-style:italic;color:rgba(255,255,255,.9);margin:10px 0 6px;background:rgba(0,0,0,.3);border-radius:8px;padding:10px 16px;display:inline-block;line-height:1.5}
  .phase-banner .emoji{font-size:3em;margin-bottom:8px;display:block}
  .cycle-bar{background:#222;border-radius:100px;height:10px;margin:10px 0 4px;overflow:hidden}
  .cycle-bar-fill{height:100%;border-radius:100px}
  .cycle-meta{display:flex;justify-content:space-between;font-size:.75em;color:#666}
  .card{background:#1a1a1a;border-radius:14px;padding:20px;margin-bottom:16px;border-left:4px solid #e94560}
  .card h4{font-size:.8em;text-transform:uppercase;letter-spacing:1px;color:#e94560;margin-bottom:10px;font-weight:700}
  .card p{color:#ccc;line-height:1.6;font-size:.95em}
  .tip-list{list-style:none}
  .tip-list li{padding:8px 0;color:#ccc;font-size:.9em;border-bottom:1px solid #222;line-height:1.5}
  .tip-list li:last-child{border-bottom:none}
  .dont-say{background:#1a0a0a;border-left-color:#ff4444}
  .dont-say h4{color:#ff4444}
  .dont-item{background:#2a1111;border-radius:8px;padding:10px 14px;margin-bottom:8px;font-size:.88em;color:#ffaaaa;font-style:italic}
  .dont-item::before{content:'üö´ '}
  .win-points{background:#0a1a0a;border-left-color:#44cc44}
  .win-points h4{color:#44cc44}
  .meno-focus{border-radius:14px;padding:20px;margin-bottom:16px}
  .meno-focus h4{font-size:.8em;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;font-weight:700}
  .meno-focus p{color:#ddd;line-height:1.6;font-size:.92em}
  .overview-card{background:#1a1a2e;border-radius:14px;padding:20px;margin-bottom:16px;border-left:4px solid #9966ff}
  .overview-card h4{color:#cc99ff;font-size:.8em;text-transform:uppercase;letter-spacing:1px;font-weight:700;margin-bottom:10px}
  .phase-ref{background:#1a1a1a;border-radius:14px;padding:18px;margin-bottom:14px}
  .no-data{text-align:center;padding:60px 20px}
  .no-data .big{font-size:4em;margin-bottom:16px}
  .no-data p{color:#888;margin-bottom:24px}
  .history-item{background:#1a1a1a;border-radius:10px;padding:12px 16px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;font-size:.9em}
  .del{background:none;border:none;color:#555;cursor:pointer;font-size:1.1em}
  .del:hover{color:#e94560}
  .learned-badge{background:#1a2a0a;border:1px solid #44cc44;border-radius:8px;padding:8px 12px;font-size:.82em;color:#aaffaa;margin-bottom:16px;text-align:center}
  .section-title{font-size:.8em;text-transform:uppercase;letter-spacing:1px;color:#666;margin:20px 0 10px;font-weight:700}
  hr{border:none;border-top:1px solid #222;margin:20px 0}
  .setup-card{background:#1a1a2e;border-radius:16px;padding:30px}
  .user-bar{display:flex;align-items:center;justify-content:space-between;background:#1a1a1a;border-radius:10px;padding:10px 16px;margin-bottom:16px;font-size:.85em}
  .tag{display:inline-block;background:#e94560;border-radius:6px;padding:2px 8px;font-size:.75em;font-weight:700;margin-left:8px;vertical-align:middle}
  .rel-badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:.78em;font-weight:700;margin-bottom:10px;background:rgba(0,0,0,.3);color:rgba(255,255,255,.85);border:1px solid rgba(255,255,255,.2)}
  .stage-pill{display:inline-block;padding:3px 10px;border-radius:20px;font-size:.75em;font-weight:700;margin-left:6px;background:#2a1a3d;color:#cc99ff;border:1px solid #6633cc}
  .warning-banner{background:#2a1a00;border:1px solid #cc7700;border-radius:10px;padding:12px 16px;margin-bottom:16px;font-size:.84em;color:#ffaa44;line-height:1.6}
  .info-banner{background:#1a1a2e;border:1px solid #336699;border-radius:10px;padding:12px 16px;margin-bottom:16px;font-size:.84em;color:#88aaff;line-height:1.6}
  .divider-label{text-align:center;font-size:.75em;text-transform:uppercase;letter-spacing:2px;color:#444;margin:20px 0;position:relative}
  .divider-label::before,.divider-label::after{content:'';position:absolute;top:50%;width:35%;height:1px;background:#222}
  .divider-label::before{left:0} .divider-label::after{right:0}
  .loading{text-align:center;padding:60px 20px;color:#888}
  .spinner{display:inline-block;width:32px;height:32px;border:3px solid #333;border-top-color:#e94560;border-radius:50%;animation:spin .8s linear infinite;margin-bottom:12px}
  @keyframes spin{to{transform:rotate(360deg)}}
  .emailjs-info{background:#1a1a0a;border:1px solid #665500;border-radius:10px;padding:14px;margin-bottom:16px;font-size:.82em;color:#ccaa44;line-height:1.8}
  .emailjs-info a{color:#ffcc44}
  footer{text-align:center;padding:20px;color:#333;font-size:.75em}
</style>
</head>
<body>

<div id="auth-screen">
  <div class="auth-card">
    <div class="logo">üéØ</div>
    <h2>GUY'S GUIDE TO <span>LADIES</span></h2>
    <p>Your daily relationship intelligence system</p>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tab-login">Sign In</button>
      <button class="auth-tab" id="tab-signup">Create Account</button>
    </div>
    <div id="auth-err" class="err"></div>
    <div id="login-form">
      <label>Email</label><input type="email" id="login-email" placeholder="you@example.com"/>
      <label>Password</label><input type="password" id="login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
      <button class="btn" id="btn-login">Sign In</button>
      <button class="btn btn-outline" id="btn-google-1">üîµ Continue with Google</button>
    </div>
    <div id="signup-form" style="display:none">
      <label>Your Name</label><input type="text" id="signup-name" placeholder="e.g. Mike"/>
      <label>Email</label><input type="email" id="signup-email" placeholder="you@example.com"/>
      <label>Password</label><input type="password" id="signup-pass" placeholder="min 6 characters"/>
      <button class="btn" id="btn-signup">Create Account</button>
      <button class="btn btn-outline" id="btn-google-2">üîµ Continue with Google</button>
    </div>
  </div>
</div>

<header>
  <h1>GUY'S GUIDE TO <span>LADIES</span></h1>
  <p>Your daily relationship intelligence system</p>
</header>
<nav>
  <button class="active" id="nav-dashboard">üìä Today</button>
  <button id="nav-setup">‚öôÔ∏è Setup</button>
  <button id="nav-reference">üìñ Guide</button>
</nav>
<div id="dashboard" class="page active"><div class="loading"><div class="spinner"></div><p>Loading...</p></div></div>
<div id="setup" class="page"></div>
<div id="reference" class="page"></div>
<footer>Made with ‚ù§Ô∏è for the guys who actually give a damn</footer>

<script>
// ‚îÄ‚îÄ Seed helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function seedRand(s){return()=>{s=Math.sin(s)*10000;return s-Math.floor(s);}}
function dailySeed(){const d=new Date();return d.getFullYear()*10000+(d.getMonth()+1)*100+d.getDate();}
function pickN(arr,n,rng){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(rng()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a.slice(0,Math.min(n,a.length));}
function pickOne(arr,rng){return arr[Math.floor(rng()*arr.length)];}

// ‚îÄ‚îÄ Life stage ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getLifeStage(age){
  const a=parseInt(age)||30;
  if(a<=17)return'teen';
  if(a<=25)return'youngadult';
  if(a<=39)return'adult';
  if(a<=54)return'perimenopause';
  if(a<=58)return'menopause';
  return'postmenopause';
}
function isRomantic(rel){return rel==='wife'||rel==='girlfriend';}
function stageLabel(s){return{'teen':'üëß Teen','youngadult':'üå∏ Young Adult','adult':'üí™ Adult','perimenopause':'üåø Perimenopause','menopause':'üåô Menopause','postmenopause':'‚ú® Post-Menopause'}[s]||s;}
function relLabel(r){return{'wife':'üë∞ Wife','girlfriend':'üíë Girlfriend','friend':'üëØ Friend','mom':'üíê Mom','daughter':'üåü Daughter'}[r]||r;}

// ‚îÄ‚îÄ Menopause focus cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const MENO_FOCUSES=[
  {emoji:'üî•',name:'Hot Flash Day',color:'linear-gradient(135deg,#3d1500,#7a2a00)',borderColor:'#cc4400',
   desc:'Hot flashes can strike without warning. Her thermoregulation is off and her body is working overtime to compensate. One of the most physically disruptive symptoms of this transition.',
   tips:['‚úÖ Keep rooms cooler than usual ‚Äî quietly adjust the thermostat','‚úÖ Have cold drinks ready without being asked','‚úÖ Don\'t comment on sweating or flushing','‚úÖ Keep a fan available','‚úÖ Avoid heavy hot meals tonight ‚Äî suggest something lighter'],
   donts:['‚ùå Don\'t turn the heat up','‚ùå Don\'t comment on how flushed she looks','‚ùå Don\'t say "just cool down"','‚ùå Don\'t book a hot restaurant or sauna experience today'],
   wins:['üå¨Ô∏è Set up a fan in the bedroom before she asks','üßä Keep cold drinks stocked all day','üõèÔ∏è Swap to breathable cotton bedding tonight','üíÜ Offer a cool compress for her neck','üõí Surprise her with a personal cooling fan or cooling mist spray','ü•ó Suggest a lighter dinner ‚Äî salad, cold cuts, something easy','üéÅ Research menopause cooling products and pick one up']},
  {emoji:'üß†',name:'Brain Fog Day',color:'linear-gradient(135deg,#0d1a3d,#1a2a6b)',borderColor:'#3355cc',
   desc:'Estrogen plays a direct role in cognitive function. As it fluctuates, memory, focus and clarity dip. She\'s not losing it ‚Äî her brain chemistry is genuinely shifting. Patience isn\'t optional today.',
   tips:['‚úÖ Don\'t put her on the spot or expect fast decisions','‚úÖ Write things down ‚Äî don\'t rely on her memory','‚úÖ Be patient if she loses her train of thought mid-sentence','‚úÖ Take over logistics and admin where you can','‚úÖ Keep the environment calm and low-stimulation'],
   donts:['‚ùå Don\'t say "you already told me that"','‚ùå Don\'t make her feel silly for forgetting','‚ùå Don\'t pile decisions or information on her','‚ùå Don\'t fill the day with tasks requiring mental energy'],
   wins:['üìã Handle all shared admin and logistics today','üßò Keep the house calm ‚Äî low noise, low chaos','üí¨ Be patient mid-conversation without making it obvious','‚òï Bring her coffee or tea ‚Äî caffeine helps clarity slightly','üõí Do the grocery run so she doesn\'t have to think about it','üç≥ Cook dinner so meal planning is off her plate','ü§ç Remind her she\'s sharp and capable ‚Äî she needs to hear it']},
  {emoji:'üòî',name:'Emotional Intensity Day',color:'linear-gradient(135deg,#2a0a2a,#4a1a4a)',borderColor:'#772299',
   desc:'Hormonal fluctuations during menopause directly affect serotonin and dopamine. Sadness, anxiety, or irritability can surface suddenly. This is neurochemical ‚Äî not weakness, not drama.',
   tips:['‚úÖ Listen without trying to fix or explain','‚úÖ Validate her feelings ‚Äî don\'t minimise them','‚úÖ Be a calm, steady presence today','‚úÖ Don\'t take emotional reactions personally','‚úÖ Check in gently ‚Äî a simple "you okay?" matters'],
   donts:['‚ùå Don\'t say "it\'s just your hormones"','‚ùå Don\'t dismiss or minimise what she\'s feeling','‚ùå Don\'t go quiet or withdraw ‚Äî she needs presence','‚ùå Don\'t start difficult conversations today'],
   wins:['ü§ó Long genuine hug ‚Äî hold it, don\'t rush it','üíå Send a thoughtful check-in text during the day','üïØÔ∏è Create a calm atmosphere ‚Äî dim lights, quiet music','üå∏ Pick up flowers on the way home','üçï Order her favourite comfort food ‚Äî no discussion needed','üí¨ Tell her something specific you love about her','üßñ No-expectation massage ‚Äî back, shoulders, or feet']},
  {emoji:'üò¥',name:'Sleep Disruption Day',color:'linear-gradient(135deg,#0a1a2a,#1a2a3d)',borderColor:'#2255aa',
   desc:'Night sweats and hormonal shifts frequently wreck sleep during menopause. Poor sleep amplifies every other symptom ‚Äî mood, cognition, pain tolerance, and emotional regulation all worsen without rest.',
   tips:['‚úÖ Let her sleep in or rest without disturbance','‚úÖ Keep noise down in the morning','‚úÖ Handle morning responsibilities yourself','‚úÖ Suggest an early, quiet evening','‚úÖ Make the bedroom as cool and comfortable as possible'],
   donts:['‚ùå Don\'t wake her unnecessarily','‚ùå Don\'t make noise while she\'s still resting','‚ùå Don\'t dismiss tiredness as laziness or attitude','‚ùå Don\'t plan anything demanding today'],
   wins:['üõèÔ∏è Set the bedroom to a cool, dark, quiet sleep environment','‚òï Let her sleep and handle the morning solo','üßò Suggest an early, relaxed evening with zero commitments','üçµ Make calming herbal tea before bed','üõí Pick up magnesium supplements ‚Äî they genuinely help sleep','üìµ Phone on silent so it doesn\'t wake her','üéÅ Lavender pillow spray or a sleep mask as a thoughtful surprise']},
  {emoji:'‚ö°',name:'Low Energy Day',color:'linear-gradient(135deg,#1a1a0a,#2a2a1a)',borderColor:'#887700',
   desc:'Hormonal shifts, disrupted sleep, and metabolic changes during menopause create real fatigue. Her body is doing enormous biological work. Low energy today is not laziness ‚Äî it\'s physiology.',
   tips:['‚úÖ Reduce her mental and physical load wherever possible','‚úÖ Don\'t plan demanding activities or outings','‚úÖ Handle chores and logistics proactively','‚úÖ Let her rest without guilt or commentary','‚úÖ Keep the atmosphere calm and pressure-free'],
   donts:['‚ùå Don\'t suggest she "push through it"','‚ùå Don\'t load the day with plans','‚ùå Don\'t make her feel guilty for needing rest','‚ùå Don\'t compare her energy to other days'],
   wins:['üßπ Do all chores quietly ‚Äî no announcement needed','üõí Handle all errands and shopping today','üç≤ Cook a nourishing meal ‚Äî food is one less decision for her','üõãÔ∏è Set up a comfortable rest spot ‚Äî blanket, cushions, remote','üì∫ Queue her favourite show without being asked','‚òï Keep her supplied with hot drinks all day','üå∫ Small treat or flowers ‚Äî remind her she\'s loved on tough days']}
];

const POSTMENO={
  overview:'Hormones have settled at their new lower baseline. The intense transitional storm has passed. Lower estrogen still affects mood, energy, joints, and emotional wellbeing ‚Äî but the unpredictability has eased. She\'s entered a new chapter and deserves a partner who consistently shows up for it.',
  tips:['‚úÖ Stay attentive ‚Äî lower estrogen still affects mood and energy daily','‚úÖ Support her independence, friendships, and interests','‚úÖ Be affectionate and warm ‚Äî physical touch and connection remain vital','‚úÖ Plan enjoyable, comfortable activities together','‚úÖ Celebrate who she is at this stage ‚Äî she has earned it'],
  donts:['‚ùå Don\'t assume everything is normal ‚Äî some symptoms persist','‚ùå Don\'t make her feel invisible or irrelevant','‚ùå Don\'t ignore signs of low mood or withdrawal from life'],
  wins:['üå∫ Plan a lovely day out ‚Äî relaxed, enjoyable, no pressure','üíå Write her a note about what you admire about her strength and journey','üßñ Book her a spa day or massage as a proper treat','üåç Plan a trip or experience she\'s been wanting to do','‚òï Regular coffee or lunch dates ‚Äî invest in consistent quality time','üíê Flowers regularly ‚Äî keep the romance and appreciation alive','üéÅ Thoughtful gifts that reflect her passions and interests','üé≠ Book tickets to something she\'d genuinely love','üí¨ Have deep conversations ‚Äî she has real wisdom, engage with it','ü§ù Encourage and support her social life and friendships']
};

// ‚îÄ‚îÄ Phase data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const PHASES=[
  {name:'Menstruation',days:[1,2,3,4,5],emoji:'üî¥',color:'linear-gradient(135deg,#3d0000,#7a0020)',
   oneliners:{
     wife:["Bro, she's on her period. Your job this week: snacks, patience, and zero drama. That's literally it.","Period week, mate. Keep your mouth shut, the chocolate stocked, and the heating pad charged. Easy win.","She's not feeling great and that's okay. Be the husband who shows up quietly. Big points for small things.","Her hormones are in the basement. Be warm, be useful, be easy to be around. In that order.","Think of this as the reset week. Less talk, more doing. She will remember how you showed up."],
     girlfriend:["Bro, she's on her period. Snacks, patience, shut up about the guys trip. That's the whole brief.","She's not at her best physically ‚Äî be the guy who makes it easier, not harder. Simple.","Period week. Be low-maintenance, high-kindness. She'll clock it, trust me.","She needs comfort, not conversation. Show up with warmth and zero agenda.","Less is more this week, mate. Be present, be gentle, be useful."],
     friend:["Your girl mate's on her period and probably not feeling great. Check in, don't push plans, be a decent human.","She might cancel or go quiet this week ‚Äî don't take it personally. A kind message goes a long way.","Be the friend who checks in without needing anything back. That's the move right now.","A simple 'hey, you good?' goes further than you think this week. Send it.","Don't push social plans. Let her come to you when she's ready. No pressure."],
     mom:["Your mum's not feeling great this week. Be helpful, be kind, and don't add to her load. Simple.","Call her. Do something useful. Be the kid she brags about ‚Äî especially this week.","She carried you for nine months. The least you can do is be extra patient this week, mate.","Help out without being asked. Worth more than you know to her right now.","Be the son who shows up this week. Call, help, be warm. That's it."],
     daughter:["Your daughter's not feeling well, dad. Go easy on expectations and make sure she knows you've got her back.","Low energy, possible discomfort. Keep things light and don't push for big conversations this week.","Be the safe, calm presence she needs right now. No big talks, no pressure, just warmth.","Check in gently. Make sure she has what she needs. That's your job this week, dad.","Dad mode: fully active. She needs comfort and zero pressure. You've got this."]
   },
   hormones_std:'Estrogen and progesterone are at their lowest. The uterine lining is shedding, which takes real energy. Cramps, back pain, fatigue, and emotional sensitivity are all physiologically real.',
   hormones_peri:'Estrogen and progesterone are dropping, but perimenopause means these fluctuations can be more unpredictable and intense. Cramps may be heavier or lighter than usual, and emotional sensitivity can be amplified. Expect more, not less.',
   hormones_meno:'At this stage periods may still occur occasionally but are becoming rare. When they do arrive, they can be heavier, longer, or more uncomfortable than in earlier years. Hormonal shifts are more extreme.',
   mood:'Tired, possibly uncomfortable, emotionally sensitive. She needs warmth and understanding ‚Äî not logic or demands.',
   dos:['‚úÖ Be extra patient and understanding','‚úÖ Bring her comfort food or her favourite snack','‚úÖ Offer a heating pad or hot water bottle','‚úÖ Let her choose what you watch','‚úÖ Handle chores quietly without making it a big deal'],
   donts:['‚ùå Don\'t bring up money, big plans, or unresolved issues','‚ùå Don\'t start serious debates','‚ùå Don\'t minimise her pain or discomfort','‚ùå Don\'t make her feel guilty for resting','‚ùå Don\'t bring up the guys trip'],
   notsay_romantic:["\"You're always like this once a month\"","\"It's just cramps, you'll be fine\"","\"Can I go out with the guys?\"","\"Why are you so moody?\"","\"Other girls don't make such a big deal\""],
   notsay_friend:["\"You're being so dramatic\"","\"Can you just snap out of it?\"","\"You cancelled on me again\"","\"You seem really moody lately\""],
   notsay_family:["\"You're always difficult this week\"","\"What's wrong with you?\"","\"You're overreacting\"","\"Just push through it\""],
   wins_romantic:['üíÜ Back or foot massage ‚Äî no strings attached','üç´ Surprise her with chocolate or her comfort food','üì∫ Cosy night in ‚Äî her choice of show, zero complaints','üõÅ Draw her a warm bath','üßπ Quietly clean the kitchen or bathroom','üõí Pick up whatever she needs without being asked','üçµ Make her a hot drink exactly how she likes it','üì± Send a sweet "thinking of you" text mid-day','üõèÔ∏è Let her rest without interrupting','üç≤ Cook a warm comforting meal ‚Äî soup, pasta, whatever she loves'],
   wins_friend:['üì± Send a "hey, you good?" ‚Äî genuine, no agenda','üçµ Suggest comfort food or a low-key hang','üí¨ Just listen if she wants to vent ‚Äî no advice needed','üõí Offer to pick something up if you\'re passing by','üé¨ Suggest a chill catch-up when she\'s feeling better'],
   wins_family:['üìû Call and ask how she\'s doing ‚Äî and mean it','üç≤ Cook or bring her a meal','üßπ Help around the house without being asked','üí¨ Be patient and kind in every interaction this week','üõí Handle errands for her if you can']},

  {name:'Follicular Phase',days:[6,7,8,9,10,11,12],emoji:'üå∏',color:'linear-gradient(135deg,#0a2a3d,#0d4a6b)',
   oneliners:{
     wife:["Bro, she's basically a cheat code right now. Estrogen is up, mood is great, she's open to everything. Plan something. Don't waste this window.","Green light week, mate. She'll say yes to almost anything. Have you booked that trip yet? Because now's the time.","She's sharp, happy, and social. If you've been avoiding a big conversation ‚Äî this is your window. Don't blow it.","Her energy is through the roof. Match it or get left behind. Plan a proper date. Actually follow through.","This is her superhero phase. Be the sidekick she deserves ‚Äî plans, adventures, actual effort. Go."],
     girlfriend:["Bro, she's in her element right now. Happy, energetic, social. Stop sitting at home ‚Äî plan something worth her time.","Green light week. She's up for new things, big conversations, and actual adventures. What are you waiting for?","She's firing on all cylinders. Match her energy or she'll outshine you. Plan a date. Follow through.","This is the week to bring up anything important. She's sharp, open, and genuinely receptive. Go for it.","Her vibe is immaculate. Don't waste it on Netflix again. Take her somewhere worth remembering."],
     friend:["Your girl friend is in her prime social mode right now. Stop cancelling and actually make plans, mate.","She's sharp, energetic, and up for fun. Good time to suggest that thing you've both been talking about.","She's in a great headspace ‚Äî perfect for a proper catch-up or planning something fun together.","Social energy is high. She'll be great company. Make the effort and actually reach out.","She's in a good place this week. Don't let it pass without making plans. You'll regret it if you do."],
     mom:["Your mum's in a great headspace this week ‚Äî call her, catch up, and actually listen for once.","She's feeling positive and social. Take her out for lunch or coffee. She'll absolutely love it.","Good week to have a proper conversation with your mum. She's sharp and engaged ‚Äî use the time.","She'd love to hear from you this week. Call her. Make plans. Show up. Be the good one.","She's energetic and in great spirits. Plan something with her ‚Äî doesn't need to be big, just intentional."],
     daughter:["She's in a great mood and full of energy, dad. Great time for proper quality time together.","She's open, happy, and engaged. Perfect week to connect ‚Äî ask about her life, her plans, her dreams.","Good week for a proper father-daughter hang. She's in her element ‚Äî engage with it.","She's social and outgoing right now. Be the dad who shows up and actually engages.","She'll be great company this week. Make the effort to spend time together. She'll remember it."]
   },
   hormones_std:'Estrogen is rising rapidly. The brain becomes more alert, creative, and socially confident. She feels lighter, more optimistic, and genuinely energised. This is her natural high point.',
   hormones_peri:'Estrogen is attempting to rise but may fluctuate unpredictably in perimenopause. Good days during this phase can feel great, but the reliability of the follicular energy boost is reduced. Enjoy the good days when they come ‚Äî don\'t take them for granted.',
   hormones_meno:'Estrogen remains low even during what would have been the follicular phase. However, relative hormonal shifts can still produce better days ‚Äî more energy, improved mood, and clearer thinking compared to other points in the month.',
   mood:'Happy, energetic, open-minded, extroverted. She\'s at her best and genuinely fun to be around.',
   dos:['‚úÖ Plan dates, outings, and new experiences','‚úÖ Have important conversations ‚Äî future plans, big topics','‚úÖ Try new restaurants, activities, or adventures','‚úÖ Be spontaneous and match her energy','‚úÖ Suggest social plans and actually follow through'],
   donts:['‚ùå Don\'t waste this window being boring and passive','‚ùå Don\'t keep avoiding conversations you\'ve been putting off','‚ùå Don\'t take her great mood for granted','‚ùå Don\'t bail on plans ‚Äî she\'s organised and excited right now'],
   notsay_romantic:["\"I don't feel like going out\"","\"Let's just stay home again\"","\"We can talk about that later\"","\"I forgot to make a reservation\""],
   notsay_friend:["\"I can't make it again, sorry\"","\"Maybe next time\"","\"I'm too busy this week\""],
   notsay_family:["\"I've been meaning to call\"","\"Let's catch up soon\" (with no follow-through)","\"I'm too busy right now\""],
   wins_romantic:['üéâ Plan a spontaneous adventure or fun outing','üí¨ Have that conversation you\'ve been avoiding ‚Äî she\'s receptive','üçΩÔ∏è Book a new restaurant she\'s wanted to try','üé≠ Buy tickets to a show, concert, or event','üèûÔ∏è Plan a day trip or weekend away and book it','üé® Sign up for a class or experience together','üì∏ Take her somewhere photo-worthy and make a memory','üåÜ Explore a new part of the city together','ü•Ç Surprise her with a proper date night','üå∏ Buy flowers just because ‚Äî no occasion needed'],
   wins_friend:['üìÖ Actually commit to plans and follow through','üçΩÔ∏è Book that lunch or dinner you\'ve been talking about','üé≠ Suggest something fun ‚Äî escape room, event, activity','üí¨ Have a proper catch-up ‚Äî she\'s in a great headspace for it','üèÉ Suggest an active outing ‚Äî walk, hike, class together'],
   wins_family:['üìû Call and suggest a proper catch-up ‚Äî and mean it','üçΩÔ∏è Take her out for lunch or dinner, just you two','üí¨ Have a meaningful conversation ‚Äî she\'s sharp and engaged','üöó Offer to take her somewhere she\'s been wanting to go','üéØ Plan an activity you can genuinely do together']},

  {name:'Ovulation',days:[13,14,15],emoji:'üî•',color:'linear-gradient(135deg,#3d1a00,#7a3500)',
   oneliners:{
     wife:["Bro. She is at PEAK everything right now. Confidence, energy, libido ‚Äî all maxed. Clear your calendar tonight. You're genuinely welcome.","This is the window, mate. She's glowing, she knows it, and she wants real connection. Don't be the guy who misses this.","Estrogen has peaked. Libido is dialled all the way up. She looks incredible and feels it. Plan something romantic. Tonight.","She's at her biological best right now. Be the husband who shows up, shows off, and shows out. Make it count.","Peak week. She's magnetic, confident, and ready for real intimacy. Step up, plan something, and be fully present."],
     girlfriend:["Bro, she is radiating right now. Confidence maxed, energy high, she looks incredible. Plan a proper date. Tonight.","This is her prime window. She's glowing, social, and wants real connection. Don't miss it, mate.","She's at peak energy and confidence. Be the guy who matches her intensity this week. A real date. Real effort.","She feels amazing right now ‚Äî make sure she knows you notice. Step up.","She's magnetic this week. The question is whether you're showing up at the level she deserves. Answer: yes."],
     friend:["She's in her element ‚Äî confident, social, and full of energy. Great time to make plans or reconnect.","She's feeling herself this week. Good time for a fun group outing or catch-up ‚Äî she'll be great company.","She's at her most social and energetic. Make plans. Don't overthink it. She'll be up for it.","High energy, high confidence. She'll be the life of the party ‚Äî include her in whatever you're planning.","She's glowing this week. Good time for a proper hang or a group outing. Make it happen."],
     mom:["Your mum's in great form this week ‚Äî confident, energetic, social. Great time to call or plan something together.","She's feeling good and full of energy. Perfect time to take her out or spend some proper quality time.","She's at her most engaged and sociable. Don't let it pass without reaching out and making plans.","Call her this week. She's in great spirits and would love to hear from you. Just do it.","She's sharp and social right now ‚Äî perfect week for a lunch date or family get-together."],
     daughter:["She's confident and full of energy this week, dad. Great time for a fun activity together.","She's in her element ‚Äî engage with her, celebrate that energy, and be genuinely present.","High confidence, high energy. Be the dad who shows up and matches her enthusiasm.","She's feeling great this week. Good time for a quality father-daughter moment ‚Äî make it count.","She's bright and energetic. Be present and engaged. She'll remember it more than you know."]
   },
   hormones_std:'Estrogen peaks and LH surges, triggering egg release. Highest libido, social confidence, and physical energy of the cycle. She feels and looks her absolute best.',
   hormones_peri:'Ovulation becomes irregular in perimenopause ‚Äî it may still occur but timing is unpredictable. When it does happen, the confidence and energy boost can still appear. However libido fluctuations are more complex and not always as predictable.',
   hormones_meno:'True ovulation no longer occurs, but relative hormonal shifts can still produce peak-feeling days. She may feel more energetic and socially engaged on these days compared to others.',
   mood:'Confident, flirty, energetic, passionate. She feels and looks her absolute best.',
   dos:['‚úÖ Plan something genuinely enjoyable together','‚úÖ Compliment her ‚Äî be specific and sincere','‚úÖ Be fully present ‚Äî phone down, eyes on her','‚úÖ Be affectionate and attentive','‚úÖ Make an effort with your own appearance too'],
   donts:['‚ùå Don\'t be distracted on dates','‚ùå Don\'t bring up stressful topics','‚ùå Don\'t cancel or reschedule without very good reason'],
   notsay_romantic:["\"I'm too tired tonight\"","\"Can we talk about the credit card bill?\"","\"I'm just gonna hang with the guys\"","\"You look tired\" (she doesn't ‚Äî don't say it)"],
   notsay_friend:["\"I can't make it\"","\"I'm busy this week, sorry\""],
   notsay_family:["\"I've been meaning to visit\"","\"Let me check my schedule first\""],
   wins_romantic:['üíê Buy her flowers ‚Äî unexpected, no occasion needed','üì∏ Take her somewhere she\'ll want to post about','üëó Compliment how she looks ‚Äî specific and genuine','üåô Plan an intentional romantic evening ‚Äî dinner, candles, the works','üíç Small jewellery or meaningful gift out of nowhere','ü•Ç Book a proper restaurant ‚Äî no excuses, just book it','üíå Handwritten note about what you love about her','üåπ Send flowers to her work ‚Äî make her feel celebrated publicly','üé∂ Make her a playlist of songs that remind you of her','üß¥ Book her a spa treatment as a surprise'],
   wins_friend:['üéâ Suggest a group outing or event ‚Äî she\'ll be the life of it','üì∏ Plan something fun worth a memory','üí¨ Celebrate her wins ‚Äî tell her she\'s doing great','üçΩÔ∏è Book that dinner you\'ve been meaning to sort','üé≠ Suggest something fun and social ‚Äî she\'s fully up for it'],
   wins_family:['üå∫ Take her somewhere special ‚Äî she\'s in great form','üìû Call and tell her you\'re proud of her or thinking of her','üéÅ Small thoughtful gift out of nowhere ‚Äî it will land perfectly','üçΩÔ∏è Family meal or special occasion ‚Äî make it happen this week','üí¨ Tell her something meaningful ‚Äî she\'ll carry it with her']},

  {name:'Early Luteal',days:[16,17,18],emoji:'üòå',color:'linear-gradient(135deg,#2a1a3d,#4a2a6b)',
   oneliners:{
     wife:["The high is fading, mate. She's shifting inward. Slow down, pay attention, show up with small acts of care.","Less flash, more feeling this week. Quality time over grand gestures. She'll notice the shift.","She wants depth, not distraction. Be present and genuinely attentive. Put the phone down.","She's winding down a bit. Create calm, not chaos. Small and consistent wins every time.","Pay attention to what she's not saying as much as what she is. Connection over performance."],
     girlfriend:["She's coming down from her peak ‚Äî be warm, attentive, and low-maintenance. That's all she needs.","She wants calm connection this week. Phone down, actually be present. That's the whole move.","Less big plans, more quality moments. She'll appreciate the shift more than you realise.","She might be a bit quieter ‚Äî don't read into it. Just be there, be warm, be easy.","Small consistent gestures win big this week. Think less, do more, say less."],
     friend:["She might be a bit quieter this week ‚Äî check in without pushing. A message goes a long way.","Good week for a low-key catch-up rather than something big and loud. Keep it easy.","She's turning inward a bit. A thoughtful message or low-key plan is the right move.","Don't over-plan. Suggest something easy and let her decide. No pressure.","She'll appreciate calm, easy time more than a big night out right now. Keep it simple."],
     mom:["She might be more reflective this week ‚Äî good time for a meaningful call. Just to chat.","Low-key quality time is the move. Take her for a quiet coffee. She'll love it.","She's calmer and more inward-facing ‚Äî perfect time for a genuine heart-to-heart.","Call her just to chat. Not logistics ‚Äî just to connect. It means more than you think.","Be the kid who shows up with warmth this week. She'll appreciate it more than she lets on."],
     daughter:["She might be a bit quieter this week, dad. Don't push ‚Äî just be available and genuinely warm.","Check in without pressure. Let her know you're there. That's the whole job right now.","She's more reflective right now. Good time for a gentle, low-key conversation if she wants it.","Be a calm, steady presence. No big topics, no pressure. Just warmth and availability.","Easy, no-pressure time together. No agenda. Just show up as the dad she can always count on."]
   },
   hormones_std:'Progesterone begins rising after ovulation. The peak energy starts to ease. She becomes more reflective and inward-focused, craving calmer, more intimate connection.',
   hormones_peri:'In perimenopause, progesterone levels are often lower and more erratic than in earlier years. This can make the luteal phase more emotionally turbulent than expected. The shift inward may be more pronounced.',
   hormones_meno:'Progesterone is consistently low at this life stage. The inward emotional shift associated with the luteal phase may still occur in rhythm with her body\'s remaining hormonal patterns, even if cycles are irregular.',
   mood:'Calmer, slightly more sensitive, turning inward. Wants quiet connection over big events.',
   dos:['‚úÖ Focus on quality, low-key time together','‚úÖ Be a genuinely good listener ‚Äî she may be reflective','‚úÖ Give sincere compliments about who she is as a person','‚úÖ Check in on how she\'s actually feeling','‚úÖ Take over responsibilities without announcing it'],
   donts:['‚ùå Don\'t fill the week with loud social plans','‚ùå Don\'t dismiss her if she seems quieter than usual','‚ùå Don\'t neglect small acts of warmth and affection','‚ùå Don\'t make her feel she needs to perform or be "on"'],
   notsay_romantic:["\"What's wrong with you lately?\"","\"You seem off\"","\"I need you to be more fun\"","\"Stop being so sensitive\""],
   notsay_friend:["\"You're being quiet lately\"","\"Is everything okay?\" (pushed repeatedly)","\"You seem different lately\""],
   notsay_family:["\"You seem down\"","\"Are you okay?\" (asked repeatedly without listening)","\"You're being very quiet\""],
   wins_romantic:['üç≥ Cook her favourite meal without being asked','üíå Send a genuine thoughtful text mid-day','üõãÔ∏è Cosy night in ‚Äî candles, her choice, zero agenda','üåπ Small thoughtful gift ‚Äî doesn\'t need to be expensive','üßñ Long massage ‚Äî back, shoulders, or feet','üïØÔ∏è Light candles and create a calm atmosphere at home','üìñ Buy the book she\'s been mentioning','üß∫ Do the laundry, fold it, put it away ‚Äî all of it','üçµ Make her favourite drink without asking','ü§ó Long hug ‚Äî hold it, don\'t let go first'],
   wins_friend:['üì± Send a genuine "thinking of you" message','‚òï Suggest a low-key coffee or catch-up','üí¨ Ask how she\'s really doing ‚Äî and actually listen','üé¨ Suggest a low-key movie or easy hang','üå∏ Drop off a small treat if you\'re nearby'],
   wins_family:['üìû Call just to chat ‚Äî no agenda, no logistics','üçΩÔ∏è Suggest a quiet meal together, just you two','üí¨ Have a calm, genuine conversation about something meaningful','üå∫ Drop off flowers or a small treat out of the blue','üßπ Help out around the house or with any tasks she has on']},

  {name:'PMS Phase',days:[19,20,21,22,23,24,25,26,27,28],emoji:'‚ö†Ô∏è',color:'linear-gradient(135deg,#2a1a00,#4a2e00)',
   oneliners:{
     wife:["Bro, PMS week has entered the chat. Keep your head down, your mouth shut, come home with snacks. You've got this.","This is the week that separates the men from the boys. Stay calm, stay useful, don't take the bait. Ever.","Her serotonin is in the basement. Your job: be easy to be around. That is literally the whole assignment.","PMS is not her being dramatic. Her brain chemistry is genuinely different this week. Adjust accordingly, mate.","Danger zone. No big conversations, no stupid questions, no 'are you on your period?' Just snacks and patience."],
     girlfriend:["Bro, tread carefully this week. She's not herself hormonally. Don't be the guy who makes it worse.","PMS week. Your move: snacks, patience, and zero drama. Keep it simple and you'll be fine.","Her tolerance is lower ‚Äî and that's okay. Be the boyfriend who makes this week easier, not harder.","Don't take the bait this week. Stay steady. The version of her you love will be back shortly.","This is where relationships get tested. Be the guy who shows up calmly and without agenda."],
     friend:["Your girl friend might be a bit sharp this week ‚Äî don't take it personally and don't escalate it.","Give her a bit of extra patience this week. She's dealing with a real hormonal shift.","Don't push, don't prod, don't plan big things. Just be a low-maintenance, high-quality friend.","Check in gently but don't crowd her. She'll appreciate the space and the care.","Be a steady, drama-free presence this week. That's what a real mate actually does."],
     mom:["Your mum might be a bit sharp or emotional this week ‚Äî be patient. Don't add to her load.","She's dealing with a real hormonal shift. Be the helpful, understanding son she deserves.","Don't trigger arguments this week. Help out, be kind, check in. Simple.","Be the son who reduces her stress this week, not the one who quietly adds to it.","Help around the house. Call her. Be present. She needs her load lightened ‚Äî not added to."],
     daughter:["She might be emotional or irritable this week, dad. Don't take it personally. Definitely don't comment on it.","Be patient, be kind, and absolutely do not say anything about her mood or hormones. Just be supportive.","She needs a calm, understanding presence this week. Be that for her ‚Äî no teasing, no commentary.","Don't push her buttons this week. Low pressure, high warmth. That is the entire playbook.","Be the safe, steady dad she can rely on. No teasing. No comments. Just love."]
   },
   hormones_std:'Progesterone drops sharply. Estrogen fluctuates. Serotonin dips significantly. Bloating, headaches, fatigue, and emotional sensitivity are all real physiological symptoms ‚Äî not drama.',
   hormones_peri:'In perimenopause, PMS symptoms are significantly amplified. Lower baseline progesterone and more erratic estrogen mean mood swings, irritability, anxiety, and physical discomfort can be more intense and last longer than the standard PMS window.',
   hormones_meno:'Even without a regular cycle, the hormonal fluctuations of perimenopause and menopause can mimic PMS-like symptoms. Low estrogen and progesterone combined with serotonin fluctuations create real emotional and physical challenges.',
   mood:'Irritable, emotionally heightened, possibly anxious. Small things feel disproportionately big. She\'s not doing this on purpose.',
   dos:['‚úÖ Listen without trying to problem-solve','‚úÖ Give space when needed ‚Äî read the signals','‚úÖ Show up with small, consistent acts of care','‚úÖ Validate her feelings without judgment','‚úÖ Keep shared spaces tidy ‚Äî clutter compounds stress','‚úÖ Handle your responsibilities without needing reminders'],
   donts:['‚ùå Don\'t pick fights or bring up unresolved issues','‚ùå Don\'t discuss budgets, big plans, or guys trips','‚ùå Don\'t suggest she\'s overreacting or being irrational','‚ùå Don\'t withdraw or go silent when things feel tense','‚ùå Don\'t leave her dealing with life admin alone'],
   notsay_romantic:["\"You're being irrational\"","\"Is it that time of the month again?\"","\"You need to calm down\"","\"You're overreacting\"","\"Have you gained weight?\" (NEVER. EVER. FOR ANY REASON.)","\"You're so emotional lately\""],
   notsay_friend:["\"You're being really difficult lately\"","\"I can't handle you when you're like this\"","\"What's your problem?\"","\"Drama as usual, mate\""],
   notsay_family:["\"You're always like this\"","\"What's wrong with you?\"","\"Stop being so emotional\"","\"You're being dramatic\""],
   wins_romantic:['üßò Give her space without making it cold or distant','üçï Order her favourite food ‚Äî no discussion needed, just handle it','üíÜ Massage with zero expectation of anything in return','üéÅ Small thoughtful gift ‚Äî lands huge this week, don\'t overlook it','üßπ Clean the house proactively and quietly ‚Äî no announcement','üõí Do the grocery shop and get her snacks while you\'re there','üç´ Stock comfort foods without being asked ‚Äî she\'ll notice','üì∫ Queue her comfort show and sit with her','üå∫ Flowers ‚Äî seriously, it\'s a relationship cheat code this week','üí¨ Say "I hear you" and stop there. No "but". Just stop.'],
   wins_friend:['üì± Low-key check-in message ‚Äî no pressure, no agenda','üçï Offer to grab food together if she\'s up for it','üí¨ Be a calm, drama-free presence this week','üé¨ Suggest a chill hang with zero agenda or expectations','ü§ç Just be easy to be around. That\'s the whole win.'],
   wins_family:['üßπ Help with chores without being asked or announcing it','üìû Call and just listen ‚Äî no fixing, no advice unless asked','üç≤ Cook or bring a meal ‚Äî food is love right now','üíä Make sure she has what she needs on hand','üå∫ Small flowers or a treat ‚Äî it matters more than you know']}
];

const BAR_COLORS={'Menstruation':'#cc0033','Follicular Phase':'#0088cc','Ovulation':'#ff6600','Early Luteal':'#6633cc','PMS Phase':'#cc6600'};

let auth,db,currentUser=null,userData={};

firebase.initializeApp({apiKey:'AIzaSyBHZimT1Npa5gwzCk2KDQP4kS0R4IC2qRI',authDomain:'guys-guide-to-ladies.firebaseapp.com',projectId:'guys-guide-to-ladies',storageBucket:'guys-guide-to-ladies.firebasestorage.app',messagingSenderId:'883845849328',appId:'1:883845849328:web:e24f311dc30ef1b6b52235'});
auth=firebase.auth();db=firebase.firestore();

const $=id=>document.getElementById(id);
const showErr=msg=>{const e=$('auth-err');e.textContent=msg;e.style.display='block';};
const hideErr=()=>{$('auth-err').style.display='none';};
function friendlyErr(c){return({'auth/user-not-found':'No account found.','auth/wrong-password':'Incorrect password.','auth/invalid-credential':'Incorrect email or password.','auth/email-already-in-use':'Email already in use.','auth/weak-password':'Password must be 6+ characters.','auth/invalid-email':'Invalid email.','auth/popup-closed-by-user':'Cancelled.','auth/network-request-failed':'Network error.'})[c]||'Error: '+c;}

function getPhase(day,len){const d=Math.round(Math.min(day,len)/len*28);for(const p of PHASES)if(p.days.includes(d))return p;return PHASES[4];}
function calcLearned(){const h=(userData.history||[]).map(d=>new Date(d+'T12:00:00')).sort((a,b)=>a-b);if(h.length<2)return null;const diffs=[];for(let i=1;i<h.length;i++)diffs.push(Math.round((h[i]-h[i-1])/86400000));const v=diffs.filter(d=>d>=21&&d<=45);return v.length?Math.round(v.reduce((a,b)=>a+b,0)/v.length):null;}

function getTodayInfo(){
  if(!userData.periodStart)return null;
  const len=parseInt(userData.cycleLength)||28;
  const today=new Date();today.setHours(0,0,0,0);
  const sd=new Date(userData.periodStart+'T12:00:00');sd.setHours(0,0,0,0);
  let day=(Math.floor((today-sd)/86400000)%len)+1;
  if(day<1)day=1;
  const phase=getPhase(day,len);
  const rel=userData.relationship||'girlfriend';
  const stage=getLifeStage(userData.age||30);
  const rng=seedRand(dailySeed()*100+day);
  const oneliners=phase.oneliners[rel]||phase.oneliners.girlfriend;
  const oneliner=pickOne(oneliners,rng);
  const wpPool=isRomantic(rel)?phase.wins_romantic:(rel==='friend'?phase.wins_friend:phase.wins_family);
  const winpoints=pickN(wpPool,4,rng);
  const nsPool=isRomantic(rel)?phase.notsay_romantic:(rel==='friend'?phase.notsay_friend:phase.notsay_family);
  const notsay=pickOne(nsPool,seedRand(dailySeed()*100+day+999));
  const hormones=stage==='perimenopause'?phase.hormones_peri:(stage==='menopause'?phase.hormones_meno:phase.hormones_std);
  return{phase,day,len,oneliner,winpoints,notsay,rel,stage,hormones};
}

async function loadUserData(){const snap=await db.collection('users').doc(currentUser.uid).get();userData=snap.exists?snap.data():{};}
async function saveUserData(u){userData={...userData,...u};await db.collection('users').doc(currentUser.uid).set(userData,{merge:true});}

function switchTab(t){hideErr();$('tab-login').classList.toggle('active',t==='login');$('tab-signup').classList.toggle('active',t==='signup');$('login-form').style.display=t==='login'?'block':'none';$('signup-form').style.display=t==='signup'?'block':'none';}
async function doLogin(){hideErr();const e=$('login-email').value.trim(),p=$('login-pass').value;if(!e||!p){showErr('Please enter email and password.');return;}$('btn-login').disabled=true;$('btn-login').textContent='Signing in...';try{await auth.signInWithEmailAndPassword(e,p);}catch(er){showErr(friendlyErr(er.code));$('btn-login').disabled=false;$('btn-login').textContent='Sign In';}}
async function doSignup(){hideErr();const n=$('signup-name').value.trim()||'Guy',e=$('signup-email').value.trim(),p=$('signup-pass').value;if(!e||!p){showErr('Fill in all fields.');return;}$('btn-signup').disabled=true;$('btn-signup').textContent='Creating...';try{const c=await auth.createUserWithEmailAndPassword(e,p);await c.user.updateProfile({displayName:n});await db.collection('users').doc(c.user.uid).set({name:n,email:e,createdAt:new Date().toISOString()});}catch(er){showErr(friendlyErr(er.code));$('btn-signup').disabled=false;$('btn-signup').textContent='Create Account';}}
async function doGoogle(){hideErr();try{const pr=new firebase.auth.GoogleAuthProvider();const c=await auth.signInWithPopup(pr);const r=db.collection('users').doc(c.user.uid);const s=await r.get();if(!s.exists)await r.set({name:c.user.displayName||'Guy',email:c.user.email,createdAt:new Date().toISOString()});}catch(er){showErr(friendlyErr(er.code));}}
async function doSignOut(){await auth.signOut();userData={};$('auth-screen').style.display='flex';}
auth.onAuthStateChanged(async u=>{if(u){currentUser=u;$('auth-screen').style.display='none';await loadUserData();renderDashboard();}else{currentUser=null;$('auth-screen').style.display='flex';}});

// ‚îÄ‚îÄ Dashboard ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderDashboard(){
  const dash=$('dashboard');
  const stage=getLifeStage(userData.age||30);
  const rel=userData.relationship||'girlfriend';
  const name=userData.herName||'Her';

  // Post-menopause: no cycle tracker
  if(stage==='postmenopause'){
    const rng=seedRand(dailySeed()+77);
    const wins=pickN(POSTMENO.wins,4,rng);
    dash.innerHTML=`
      <div class="user-bar"><span>üë§ <strong>${currentUser.displayName||currentUser.email}</strong></span><button class="btn btn-outline btn-sm" id="so-btn">Sign Out</button></div>
      <div class="phase-banner" style="background:linear-gradient(135deg,#1a1a2e,#2a1a3d)">
        <span class="emoji">‚ú®</span>
        <div class="rel-badge">${relLabel(rel)} ¬∑ ${stageLabel(stage)}</div>
        <h2>Tracking ${name}</h2><h3>Post-Menopause</h3>
        <div class="one-liner">"She's been through the storm and come out the other side. Be the guy who shows up consistently, thoughtfully, and without needing to be asked."</div>
      </div>
      <div class="overview-card"><h4>üåø The Steady Overview</h4><p style="color:#ccc;line-height:1.6;font-size:.95em">${POSTMENO.overview}</p></div>
      <div class="card"><h4>‚úÖ How to Show Up</h4><ul class="tip-list">${POSTMENO.tips.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card dont-say"><h4>üö´ What to Avoid</h4><ul class="tip-list">${POSTMENO.donts.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card win-points"><h4>üèÜ Win Points Today</h4><ul class="tip-list">${wins.map(w=>`<li>${w}</li>`).join('')}</ul></div>
      <button class="btn btn-outline" id="go-setup2" style="margin-bottom:20px">‚öôÔ∏è Update Info</button>`;
    $('so-btn').onclick=doSignOut;$('go-setup2').onclick=()=>showPage('setup');
    return;
  }

  // All other stages: show cycle tracker
  const info=getTodayInfo();
  if(!info){
    dash.innerHTML=`<div class="no-data"><div class="big">üìã</div><h3>No Cycle Tracked Yet</h3><p>Head to Setup to enter her cycle info.</p><button class="btn" id="go-setup">Get Started</button></div>`;
    $('go-setup').onclick=()=>showPage('setup');return;
  }
  const{phase,day,len,oneliner,winpoints,notsay,hormones}=info;
  const pct=Math.round(day/len*100),bc=BAR_COLORS[phase.name]||'#e94560';

  // Stage-specific banners
  const teenNote=stage==='teen'?`<div class="warning-banner">üëß <strong>Teen cycles</strong> are often irregular in the early years. Use this as a helpful guide ‚Äî not a precise clock. Be extra patient and understanding.</div>`:'';
  const periNote=stage==='perimenopause'?`<div class="warning-banner">üåø <strong>Perimenopause:</strong> Cycles are becoming irregular and symptoms can be more intense. Treat the cycle tracker as a guide ‚Äî not a guarantee. Expect amplified versions of each phase.</div>`:'';
  const menoNote=stage==='menopause'?`<div class="info-banner">üåô <strong>Menopause:</strong> Periods are rare or have stopped, but hormonal rhythms and phase-like patterns can still occur. The cycle tracker shows historical context. See the Daily Hormonal Focus below for today's primary guide.</div>`:'';

  // Menopause daily focus card (shown for meno + peri)
  let menoFocusHTML='';
  if(stage==='menopause'||stage==='perimenopause'){
    const rng2=seedRand(dailySeed()+55);
    const focus=pickOne(MENO_FOCUSES,rng2);
    const fwins=pickN(focus.wins,3,rng2);
    menoFocusHTML=`
      <div class="divider-label">${stage==='menopause'?'TODAY\'S HORMONAL FOCUS':'ADDITIONAL CONTEXT'}</div>
      <div class="meno-focus" style="background:${focus.color};border-left:4px solid ${focus.borderColor}">
        <h4 style="color:rgba(255,255,255,.7)">${focus.emoji} Today's Hormonal Focus</h4>
        <div style="font-size:1.3em;font-weight:900;margin-bottom:6px">${focus.name}</div>
        <p>${focus.desc}</p>
      </div>
      <div class="card" style="border-left-color:${focus.borderColor}"><h4 style="color:#ffaa66">‚úÖ Focus-Specific Tips</h4><ul class="tip-list">${focus.tips.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card dont-say" style="border-left-color:#ff4444"><h4>üö´ Avoid Today</h4><ul class="tip-list">${focus.donts.map(t=>`<li>${t}</li>`).join('')}</ul></div>
      <div class="card win-points"><h4>üèÜ Bonus Win Points (${focus.name})</h4><ul class="tip-list">${fwins.map(w=>`<li>${w}</li>`).join('')}</ul></div>`;
  }

  dash.innerHTML=`
    <div class="user-bar"><span>üë§ <strong>${currentUser.displayName||currentUser.email}</strong></span><button class="btn btn-outline btn-sm" id="so-btn">Sign Out</button></div>
    ${teenNote}${periNote}${menoNote}
    <div class="phase-banner" style="background:${phase.color}">
      <span class="emoji">${phase.emoji}</span>
      <div class="rel-badge">${relLabel(rel)} ¬∑ ${stageLabel(stage)}</div>
      <h2>Tracking ${name}</h2><h3>${phase.name}</h3>
      <div class="day-badge">Day ${day} of ${len}</div>
      <div class="one-liner">"${oneliner}"</div>
      <div class="cycle-bar"><div class="cycle-bar-fill" style="width:${pct}%;background:${bc}"></div></div>
      <div class="cycle-meta"><span>Day 1</span><span>${pct}% through cycle</span><span>Day ${len}</span></div>
    </div>
    <div class="card"><h4>üß¨ What's Happening Hormonally</h4><p>${hormones}</p></div>
    <div class="card"><h4>üé≠ Mood & Energy Forecast</h4><p>${phase.mood}</p></div>
    <div class="card"><h4>‚úÖ Your Action Plan Today</h4><ul class="tip-list">${phase.dos.map(d=>`<li>${d}</li>`).join('')}</ul></div>
    <div class="card"><h4>üö´ Things to Avoid Today</h4><ul class="tip-list">${phase.donts.map(d=>`<li>${d}</li>`).join('')}</ul></div>
    <div class="card dont-say"><h4>ü§ê What NOT to Say Right Now</h4><div class="dont-item">${notsay}</div></div>
    <div class="card win-points"><h4>üèÜ Win Points ‚Äî Do These Today</h4><ul class="tip-list">${winpoints.map(w=>`<li>${w}</li>`).join('')}</ul></div>
    ${menoFocusHTML}
    <button class="btn btn-outline" id="go-setup2" style="margin-bottom:20px">‚öôÔ∏è Update Info</button>`;
  $('so-btn').onclick=doSignOut;
  $('go-setup2').onclick=()=>showPage('setup');
}

// ‚îÄ‚îÄ Setup ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const EMAIL_TEMPLATE=`<!DOCTYPE html><html><head><meta charset="UTF-8"></head><body style="margin:0;padding:0;background:#0f0f0f;font-family:'Segoe UI',Arial,sans-serif;"><table width="100%" cellpadding="0" cellspacing="0" style="background:#0f0f0f;padding:30px 20px;"><tr><td align="center"><table width="100%" style="max-width:560px;"><tr><td style="background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:16px 16px 0 0;padding:28px 30px;text-align:center;border-bottom:3px solid #e94560;"><div style="font-size:36px;">üéØ</div><div style="color:#fff;font-size:22px;font-weight:900;">GUY'S GUIDE TO <span style="color:#e94560;">LADIES</span></div></td></tr><tr><td style="background:#1a1a2e;padding:24px 30px;text-align:center;"><div style="font-size:48px;">{{phase_emoji}}</div><div style="color:#aaa;font-size:11px;text-transform:uppercase;letter-spacing:2px;">Day {{day}} of {{cycle_length}}</div><div style="color:#fff;font-size:24px;font-weight:900;margin:6px 0;">{{phase}}</div><div style="background:rgba(255,255,255,0.07);border-radius:8px;padding:10px 16px;color:#ddd;font-size:14px;font-style:italic;">"{{one_liner}}"</div></td></tr><tr><td style="background:#111;padding:20px 30px;border-left:4px solid #e94560;"><div style="color:#e94560;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">üß¨ What's Happening Hormonally</div><div style="color:#ccc;font-size:14px;line-height:1.7;">{{hormones}}</div></td></tr><tr><td style="background:#0f0f0f;padding:20px 30px;border-left:4px solid #6633cc;"><div style="color:#9966ff;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">üé≠ Mood & Energy Today</div><div style="color:#ccc;font-size:14px;line-height:1.7;">{{mood}}</div></td></tr><tr><td style="background:#0a1a0a;padding:20px 30px;border-left:4px solid #44cc44;"><div style="color:#44cc44;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:8px;">üèÜ Win Move Today</div><div style="color:#ccc;font-size:15px;line-height:1.7;">{{tip}}</div></td></tr><tr><td style="background:#1a0a0a;padding:20px 30px;border-left:4px solid #ff4444;"><div style="color:#ff4444;font-size:11px;font-weight:700;text-transform:uppercase;margin-bottom:10px;">ü§ê Do NOT Say This</div><div style="background:#2a1111;border-radius:8px;padding:12px 16px;color:#ffaaaa;font-size:14px;font-style:italic;">üö´ {{not_say}}</div></td></tr><tr><td style="background:#0a0a0a;border-radius:0 0 16px 16px;padding:20px 30px;text-align:center;border-top:1px solid #222;"><div style="color:#444;font-size:12px;">Made with ‚ù§Ô∏è for the guys who actually give a damn</div></td></tr></table></td></tr></table></body></html>`;

function renderSetup(){
  const learned=calcLearned(),h=(userData.history||[]).sort((a,b)=>new Date(b)-new Date(a));
  const rel=userData.relationship||'girlfriend';
  const age=userData.age||'';
  const stage=getLifeStage(age||30);
  const isPost=stage==='postmenopause';
  $('setup').innerHTML=`
    <div class="setup-card">
      <h2>Her Profile</h2>
      <p style="color:#888;margin-bottom:20px;font-size:.9em">Syncs across all your devices ‚òÅÔ∏è</p>
      <label>Her Name</label><input id="her-name" value="${userData.herName||''}" placeholder="e.g. Sarah"/>
      <label>Relationship</label>
      <select id="her-rel">
        <option value="wife" ${rel==='wife'?'selected':''}>üë∞ Wife</option>
        <option value="girlfriend" ${rel==='girlfriend'?'selected':''}>üíë Girlfriend</option>
        <option value="friend" ${rel==='friend'?'selected':''}>üëØ Friend</option>
        <option value="mom" ${rel==='mom'?'selected':''}>üíê Mom</option>
        <option value="daughter" ${rel==='daughter'?'selected':''}>üåü Daughter</option>
      </select>
      <label>Her Age</label>
      <input type="number" id="her-age" value="${age}" placeholder="e.g. 34" min="13" max="80"/>
      <div style="background:#1a1a0a;border:1px solid #444;border-radius:8px;padding:10px 14px;font-size:.82em;color:#aaa;margin-bottom:16px;">
        üìä Life stage: <strong style="color:#fff">${stageLabel(stage)}</strong>${stage==='perimenopause'?' ‚Äî cycle tracker shown with amplified symptom descriptions + daily hormonal focus':stage==='menopause'?' ‚Äî cycle tracker shown as historical context + daily hormonal focus dashboard':stage==='postmenopause'?' ‚Äî cycle tracker replaced with steady-state dashboard':''}
      </div>
      <label>First Day of Most Recent Period</label>
      <input type="date" id="period-start" value="${userData.periodStart||''}"/>
      ${!isPost?`<label>Cycle Length (days)${learned?' <span class="tag">üìà LEARNED</span>':''}</label>
      <input type="number" id="cycle-length" value="${learned||userData.cycleLength||28}" min="21" max="45"/>
      ${learned?`<div class="learned-badge">‚úÖ Auto-calculated from ${h.length} logged periods</div>`:''}`:''}
      ${isPost?'<p style="color:#888;font-size:.82em;margin-bottom:16px;padding:10px;background:#1a1a1a;border-radius:8px;">üíú Post-menopause: cycle length not required. You can still log occasional periods if they occur.</p>':''}
      <button class="btn" id="save-btn">üíæ Save Profile</button>
      <hr>
      <div class="section-title">üìÖ Log New Period Start</div>
      <p style="color:#888;font-size:.85em;margin-bottom:14px">Log each new period start so the app learns her cycle and tracks history.</p>
      <label>New Period Start Date</label><input type="date" id="new-period-date"/>
      <button class="btn btn-outline" id="log-btn">‚ûï Log Period Start</button>
      ${h.length?`
        <div class="section-title">üìÖ Period History (${h.length} logged)</div>
        ${learned?`<div class="learned-badge">üìà Learned cycle: <strong>${learned} days</strong></div>`:''}
        ${h.map(d=>`<div class="history-item"><span>üî¥ ${new Date(d+'T12:00:00').toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'})}</span><button class="del" data-date="${d}">üóëÔ∏è</button></div>`).join('')}
      `:''}
      <hr>
      <div class="section-title">üîî Browser Notifications</div>
      <button class="btn btn-green" id="notif-btn">üîî Enable Browser Notifications</button>
      <hr>
      <div class="section-title">üìß Email Reminders (EmailJS)</div>
      <div class="emailjs-info">1. Sign up free at <a href="https://emailjs.com" target="_blank">emailjs.com</a><br>2. Create an Email Service (Gmail works great)<br>3. Create a Template ‚Äî paste our pre-built code using the button below<br>4. Enter your IDs below</div>
      <button class="btn btn-outline" id="copy-template-btn" style="margin-bottom:16px">üìã Copy Email Template Code</button>
      <label>Your Email</label><input type="email" id="notify-email" value="${userData.notifyEmail||''}" placeholder="you@example.com"/>
      <label>EmailJS Service ID</label><input id="ejs-svc" value="${userData.ejsSvc||''}" placeholder="service_xxxxxxx"/>
      <label>EmailJS Template ID</label><input id="ejs-tmpl" value="${userData.ejsTmpl||''}" placeholder="template_xxxxxxx"/>
      <label>EmailJS Public Key</label><input id="ejs-key" value="${userData.ejsKey||''}" placeholder="xxxxxxxxxxxxxx"/>
      <button class="btn btn-green" id="save-email-btn">üìß Save Email Settings</button>
      <button class="btn btn-outline" id="test-email-btn">üß™ Send Test Email</button>
      <hr>
      <button class="btn btn-outline" id="so-btn2">üö™ Sign Out</button>
    </div>`;

  $('save-btn').onclick=async()=>{
    const herName=$('her-name').value||'Her',relationship=$('her-rel').value,age=parseInt($('her-age').value)||30;
    const st=getLifeStage(age),isPostNow=st==='postmenopause';
    const updates={herName,relationship,age};
    const periodStart=$('period-start').value;
    if(periodStart){const h2=userData.history||[];if(!h2.includes(periodStart))h2.push(periodStart);updates.periodStart=periodStart;updates.history=h2;}
    if(!isPostNow){
      const cl=$('cycle-length');
      if(cl)updates.cycleLength=parseInt(cl.value)||28;
    }
    if(!periodStart&&!isPostNow){alert('Please enter the first day of her period.');return;}
    await saveUserData(updates);alert('‚úÖ Profile saved and synced!');showPage('dashboard');
  };

  $('log-btn').onclick=async()=>{
    const d=$('new-period-date').value;if(!d){alert('Please enter a date.');return;}
    const h2=userData.history||[];if(!h2.includes(d))h2.push(d);
    const sorted=[...h2].sort((a,b)=>new Date(b)-new Date(a));
    const lrn=calcLearned();const upd={history:h2,periodStart:sorted[0]};
    if(lrn)upd.cycleLength=lrn;
    await saveUserData(upd);alert(`‚úÖ Period logged!${lrn?`\nüìà Learned cycle: ${lrn} days`:''}`);renderSetup();
  };

  document.querySelectorAll('.del').forEach(btn=>{btn.onclick=async()=>{const h2=(userData.history||[]).filter(d=>d!==btn.dataset.date);await saveUserData({history:h2});renderSetup();};});

  $('notif-btn').onclick=()=>{if(!('Notification' in window)){alert('Not supported.');return;}Notification.requestPermission().then(p=>{if(p==='granted')alert('‚úÖ Enabled!');});};
  $('copy-template-btn').onclick=()=>{navigator.clipboard.writeText(EMAIL_TEMPLATE).then(()=>{const b=$('copy-template-btn');b.textContent='‚úÖ Copied!';b.style.borderColor='#44cc44';b.style.color='#44cc44';setTimeout(()=>{b.textContent='üìã Copy Email Template Code';b.style.borderColor='';b.style.color='';},3000);}).catch(()=>alert('Copy failed.'));};
  $('save-email-btn').onclick=async()=>{await saveUserData({notifyEmail:$('notify-email').value,ejsSvc:$('ejs-svc').value,ejsTmpl:$('ejs-tmpl').value,ejsKey:$('ejs-key').value});alert('‚úÖ Email settings saved!');};
  $('test-email-btn').onclick=()=>{
    const{notifyEmail:em,ejsSvc:sv,ejsTmpl:tm,ejsKey:ky}=userData;
    if(!em||!sv||!tm||!ky){alert('Fill in all EmailJS fields first.');return;}
    const i=getTodayInfo();if(!i){alert('Set up her cycle first.');return;}
    emailjs.init(ky);
    emailjs.send(sv,tm,{to_email:em,her_name:userData.herName||'Her',phase:i.phase.name,phase_emoji:i.phase.emoji,day:i.day,cycle_length:i.len,one_liner:i.oneliner,hormones:i.hormones,mood:i.phase.mood,tip:i.winpoints[0],not_say:i.notsay,progress_pct:Math.round(i.day/i.len*100)})
      .then(()=>alert('‚úÖ Test email sent!'),e=>alert('‚ùå '+JSON.stringify(e)));
  };
  $('so-btn2').onclick=doSignOut;
}

// ‚îÄ‚îÄ Reference ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderReference(){
  $('reference').innerHTML=
    `<h2 style="margin-bottom:16px;font-size:1.2em">üìñ Complete Cycle Guide</h2>`+
    PHASES.map(p=>`<div class="phase-ref">
      <h3 style="margin-bottom:6px">${p.emoji} ${p.name} <span style="color:#666;font-size:.8em">(Days ${p.days[0]}‚Äì${p.days[p.days.length-1]})</span></h3>
      <p style="margin-bottom:8px;color:#888;font-size:.85em;line-height:1.5">${p.hormones_std}</p>
      <p style="color:#ffaa44;font-size:.82em;margin-bottom:4px">üåø Perimenopause: ${p.hormones_peri.substring(0,80)}...</p>
      <p style="color:#ff6666;font-size:.82em;margin-bottom:4px">üö´ e.g. ${p.notsay_romantic[0]}</p>
      <p style="color:#44cc44;font-size:.82em">üèÜ e.g. ${p.wins_romantic[0]}</p>
    </div>`).join('')+
    `<h2 style="margin:24px 0 16px;font-size:1.2em">üåø Menopause Stages</h2>`+
    [['üåø Perimenopause (40‚Äì54)','Cycles become irregular, symptoms intensify. All standard phases still apply but with amplified effects. Hot flashes, brain fog, mood swings, and sleep disruption layer on top of the normal cycle symptoms. The daily Hormonal Focus card adds context alongside cycle tracking.'],
     ['üåô Menopause (51‚Äì58)','Periods are rare or have stopped. Cycle tracker shown as historical reference. Daily Hormonal Focus dashboard becomes the primary guide ‚Äî rotating through Hot Flash, Brain Fog, Emotional Intensity, Sleep Disruption, and Low Energy days.'],
     ['‚ú® Post-Menopause (55+)','Hormones have settled at a new lower baseline. No cycle tracker needed. Steady-state dashboard with consistent tips on appreciation, energy support, emotional connection, and showing up for this chapter of her life.']
    ].map(([t,d])=>`<div class="phase-ref"><h3 style="margin-bottom:6px">${t}</h3><p style="color:#888;font-size:.85em;line-height:1.5">${d}</p></div>`).join('')+
    `<h2 style="margin:24px 0 16px;font-size:1.2em">üî• Daily Hormonal Focuses (Meno)</h2>`+
    MENO_FOCUSES.map(f=>`<div class="phase-ref"><h3 style="margin-bottom:6px">${f.emoji} ${f.name}</h3><p style="color:#888;font-size:.85em;line-height:1.5">${f.desc}</p><p style="color:#44cc44;font-size:.82em;margin-top:4px">üèÜ e.g. ${f.wins[0]}</p></div>`).join('');
}

function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  $(id).classList.add('active');$('nav-'+id).classList.add('active');
  if(id==='dashboard')renderDashboard();
  if(id==='setup')renderSetup();
  if(id==='reference')renderReference();
}

$('tab-login').onclick=()=>switchTab('login');$('tab-signup').onclick=()=>switchTab('signup');
$('btn-login').onclick=doLogin;$('btn-signup').onclick=doSignup;
$('btn-google-1').onclick=doGoogle;$('btn-google-2').onclick=doGoogle;
$('nav-dashboard').onclick=()=>showPage('dashboard');
$('nav-setup').onclick=()=>showPage('setup');
$('nav-reference').onclick=()=>showPage('reference');
</script>
</body>
</html>
